
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Taylor problem 1.39 &#8212; Theoretical and computational mechanics</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"N": "\\mathbb{N}", "avec": ["\\boldsymbol{a}"], "floor": ["\\lfloor#1\\rfloor", 1], "bmat": ["\\left[\\begin{array}"], "emat": ["\\end{array}\\right]"]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Taylor problem 1.50" href="Taylor_problem_1.50.html" />
    <link rel="prev" title="Taylor Chapters 1 to 4" href="../../content/Taylor/Taylor_chapters_1to4.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/5300_icon.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Theoretical and computational mechanics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../about.html">
   About Physics 5300: Theoretical and Computational Mechanics
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Course overview
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../content/Course/overview.html">
   Objectives
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../content/Reference/installing_anaconda.html">
   Using Anaconda
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Reference/python_jupyter.html">
   Python and Jupyter notebooks
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reference/Jupyter_Python_intro_01.html">
     Python and Jupyter notebooks: part 01
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Reference/advanced.html">
   Advanced topics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/Reference/using_github.html">
     Using GitHub
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reference/Jupyter_Python_intro_02.html">
     Python and Jupyter notebooks: part 02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reference/Simple_widgets_v1.html">
     Widgets in Jupyter
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Taylor problem notebooks
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../../content/Taylor/Taylor_chapters_1to4.html">
   Taylor Chapters 1 to 4
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Taylor problem 1.39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_1.50.html">
     Taylor problem 1.50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_1.50_supplement1.html">
     Taylor problem 1.50 supplement
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_2.20_template.html">
     Taylor problem 2.20 Template
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_2.40_template.html">
     Taylor problem 2.40
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_2.43_template.html">
     Taylor problem 2.43
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_3.23.html">
     Taylor problem 3.23
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_4.29_template.html">
     Taylor problem 4.29 template
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_4.37_template.html">
     Taylor problem 4.37 template
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/Pendulum_widget_visualization_v02.html">
     Pendulum visualization using ipywidgets
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Taylor/Taylor_chapter_5.html">
   Taylor Chapter 5
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_5.2.html">
     Taylor problem 5.2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_5.13.html">
     Taylor problem 5.2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_5.32.html">
     Taylor problem 5.32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_5.36.html">
     Taylor problem 5.36 (with Example 5.3 graphs)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_5.36_atan2.html">
     Taylor problem 5.36 (with Example 5.3 graphs)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_5.50.html">
     Taylor problem 5.50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/Harmonic_oscillator_visualization_v03.html">
     Harmonic oscillator visualization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/Linear_operator_games.html">
     Demo notebook for linear operators as matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/Fourier_coefficient_intuition_v1.html">
     Fourier coefficient intuition
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reference material
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../content/zbibliography.html">
   Bibliography
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/notebooks/Taylor_problems/Taylor_problem_1.39.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/furnstahl/5300-JB"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/furnstahl/5300-JB/issues/new?title=Issue%20on%20page%20%2Fnotebooks/Taylor_problems/Taylor_problem_1.39.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/furnstahl/5300-JB/main?urlpath=tree/./notebooks/Taylor_problems/Taylor_problem_1.39.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gameplan">
   Gameplan:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-plots-of-r-and-r-textrm-max">
   Make plots of
   <span class="math notranslate nohighlight">
    \(R\)
   </span>
   and
   <span class="math notranslate nohighlight">
    \(R_\textrm{max}\)
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#widgetizing-with-ipywidgets-and-interact">
   Widgetizing with ipywidgets and interact
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ok-how-about-using-sympy">
   Ok, how about using sympy?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ok-now-as-a-differential-equation">
   Ok, now as a differential equation
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="taylor-problem-1-39">
<h1>Taylor problem 1.39<a class="headerlink" href="#taylor-problem-1-39" title="Permalink to this headline">¶</a></h1>
<p>last revised: 31-Dec-2021 by Dick Furnstahl [furnstahl.1&#64;osu.edu]</p>
<p>The goal of this notebook is to practice Python while considering some visualizations of problem 1.39 to see how they might help check the results, interpret the behavior, or suggest new ideas on how to extend the problem.  Suggestions are very welcome! We’ll use the notebook Matplotlib backend for Jupyter (<code class="docutils literal notranslate"><span class="pre">%matplotlib</span> <span class="pre">notebook</span></code>) to allow for reading points off the plot.</p>
<p><strong>Problem statement:</strong> A ball is thrown with initial speed <span class="math notranslate nohighlight">\(v_0\)</span> up an inclined plane.  The plane is inclined at an angle <span class="math notranslate nohighlight">\(\phi\)</span> above the horizontal, and the ball’s initial velocity is at an angle <span class="math notranslate nohighlight">\(\theta\)</span> above the plane.  Choose axes with <span class="math notranslate nohighlight">\(x\)</span> measured up the slope, <span class="math notranslate nohighlight">\(y\)</span> normal to the slope, and <span class="math notranslate nohighlight">\(z\)</span> across it.  Write down Newton’s second law using these axes and find the ball’s position as a function of time.  Show that the ball lands a distance</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
    R = \frac{2 v_0^2 \sin\theta \cos(\theta+\phi)}{g \cos^2\phi}
\end{align}
\]</div>
<p>from its launch point.  Show that for given <span class="math notranslate nohighlight">\(v_0\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span>, the maximum possible range up the inclined plane is</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
   R_{\textrm{max}} = \frac{v_0^2}{g(1+\sin\phi)}  \;.
\end{align}
\]</div>
<div class="section" id="gameplan">
<h2>Gameplan:<a class="headerlink" href="#gameplan" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Accept the formulas for <span class="math notranslate nohighlight">\(R\)</span> and <span class="math notranslate nohighlight">\(R_\textrm{max}\)</span> as given and make plots.  Interpret.</p></li>
<li><p>Use a fixed value of phi first, then loop through phi.</p></li>
<li><p>Add formatting to plots (and widgets!).</p></li>
<li><p>Check the formulas using sympy.</p></li>
<li><p>Solve the ODE numerically and make some spot comparisons to the formulas.</p></li>
</ul>
</div>
<div class="section" id="make-plots-of-r-and-r-textrm-max">
<h2>Make plots of <span class="math notranslate nohighlight">\(R\)</span> and <span class="math notranslate nohighlight">\(R_\textrm{max}\)</span><a class="headerlink" href="#make-plots-of-r-and-r-textrm-max" title="Permalink to this headline">¶</a></h2>
<p>We are given expressions for <span class="math notranslate nohighlight">\(R\)</span> and <span class="math notranslate nohighlight">\(R_\textrm{max}\)</span>, so we’ll first turn them into functions.  Then make some plots.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">pi</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Range_R</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mf">9.8</span><span class="p">,</span> <span class="n">v0</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Distance R up the plane given angles theta and phi.</span>
<span class="sd">    Given in Taylor problem 1.39.    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">v0</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="o">+</span><span class="n">phi</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">g</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Rmax</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mf">9.8</span><span class="p">,</span> <span class="n">v0</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Maximum distance up the plane for fixed angle phi. </span>
<span class="sd">    Given in Taylor problem 1.39.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">v0</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">g</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set up for plotting but now using the notebook backend</span>
<span class="o">%</span><span class="k">matplotlib</span> notebook
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>

<span class="c1"># The following can be uncommented if we want to adjust the font size.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make a plot of range R versus theta for several phi values</span>
<span class="n">phi_vec</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mf">8.</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">3.</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mf">8.</span><span class="p">]</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="c1"># Label the figure and axis with _R to distinguish it</span>
<span class="n">fig_R</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax_R</span> <span class="o">=</span> <span class="n">fig_R</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax_R</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distance to landing&#39;</span><span class="p">)</span>
<span class="n">ax_R</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\theta$&#39;</span><span class="p">)</span>
<span class="n">ax_R</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$R(\theta,\phi)$&#39;</span><span class="p">)</span>

<span class="c1"># start with phi=0 to see if it looks right</span>
<span class="n">ax_R</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">Range_R</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span><span class="n">phi</span><span class="o">=</span><span class="mf">0.</span><span class="p">))</span>
<span class="n">fig_R</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># make the spacing of subplots nicer</span>
</pre></div>
</div>
</div>
</div>
<p>Point to the curve to read off coordinates and try out the various controls (hover over a button to reveal a tooltip).</p>
<p>Remember that this is not a trajectory; each trajectory is just one point on this curve, specified by <span class="math notranslate nohighlight">\(\theta\)</span> and <span class="math notranslate nohighlight">\(\phi=0\)</span>.  Does the shape and features of the curve (e.g., symmetry about the peak) agree with your intuition?  Can you prove (or verify) it should be that way from the analytic formula?</p>
<p>It’s awkward to work in radians when our intuition (mine, at least) is better in degrees.  Let’s define some functions to convert (no doubt there are built-in functions, but these are easy and good practice for us).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rad_to_deg</span><span class="p">(</span><span class="n">theta_rad</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Take as input an angle in radians and return it in degrees.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">180.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">theta_rad</span>

<span class="k">def</span> <span class="nf">deg_to_rad</span><span class="p">(</span><span class="n">theta_deg</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Take as input an angle in degrees and return it in radians.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span> <span class="o">*</span> <span class="n">theta_deg</span>
</pre></div>
</div>
</div>
</div>
<p>Now make a plot with <span class="math notranslate nohighlight">\(\theta\)</span> in degrees with a list of <span class="math notranslate nohighlight">\(\phi\)</span> values, specified in radians but converted to degrees for the plot legend.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now make a plot of range R versus theta for several phi values</span>
<span class="n">phi_vec</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mf">8.</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">3.</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mf">8.</span><span class="p">,</span> <span class="mf">0.99</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">theta_deg</span> <span class="o">=</span> <span class="n">rad_to_deg</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

<span class="n">fig_R</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax_R</span> <span class="o">=</span> <span class="n">fig_R</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax_R</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distance to landing&#39;</span><span class="p">)</span>
<span class="n">ax_R</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\theta$ (degrees)&#39;</span><span class="p">)</span>
<span class="n">ax_R</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$R(\theta,\phi)$&#39;</span><span class="p">)</span>

<span class="c1">#ax_R.plot(theta, Range_R(theta,phi=0.))</span>

<span class="n">ax_R</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.15</span><span class="p">)</span>
<span class="k">for</span> <span class="n">phi</span> <span class="ow">in</span> <span class="n">phi_vec</span><span class="p">:</span>
    <span class="n">label_phi</span> <span class="o">=</span> <span class="sa">fr</span><span class="s1">&#39;$\phi = </span><span class="si">{</span><span class="n">rad_to_deg</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">\!^\circ$&#39;</span>
    <span class="n">ax_R</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_deg</span><span class="p">,</span> <span class="n">Range_R</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span><span class="n">phi</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">label_phi</span><span class="p">)</span>
<span class="n">ax_R</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">fig_R</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># make the spacing of subplots nicer</span>
</pre></div>
</div>
</div>
</div>
<p>Hmmm, it would be nice to have a picture of the incline next to this.  How would we do that?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># make a plot of range R versus theta for several phi values</span>
<span class="n">phi_vec</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mf">8.</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">3.</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mf">8.</span><span class="p">,</span> <span class="mf">0.99</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">theta_deg</span> <span class="o">=</span> <span class="n">rad_to_deg</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

<span class="n">fig_R</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax_R</span> <span class="o">=</span> <span class="n">fig_R</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax_R</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distance to landing&#39;</span><span class="p">)</span>
<span class="n">ax_R</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\theta$&#39;</span><span class="p">)</span>
<span class="n">ax_R</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$R(\theta,\phi)$&#39;</span><span class="p">)</span>

<span class="n">ax_R</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.15</span><span class="p">)</span>
<span class="k">for</span> <span class="n">phi</span> <span class="ow">in</span> <span class="n">phi_vec</span><span class="p">:</span>
    <span class="n">label_phi</span> <span class="o">=</span> <span class="sa">fr</span><span class="s1">&#39;$\phi = </span><span class="si">{</span><span class="n">rad_to_deg</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">\!^\circ$&#39;</span>
    <span class="n">ax_R</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_deg</span><span class="p">,</span> <span class="n">Range_R</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span><span class="n">phi</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">label_phi</span><span class="p">)</span>
<span class="n">ax_R</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># now add another subplot with the inclined plane.</span>
<span class="n">ax_plane</span> <span class="o">=</span> <span class="n">fig_R</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax_plane</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Inclined plane&#39;</span><span class="p">)</span>
<span class="n">ax_plane</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.1</span><span class="p">)</span>
<span class="n">ax_plane</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">phi</span> <span class="ow">in</span> <span class="n">phi_vec</span><span class="p">:</span>
    <span class="n">label_phi</span> <span class="o">=</span> <span class="sa">fr</span><span class="s1">&#39;$\phi = </span><span class="si">{</span><span class="n">rad_to_deg</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">\!^\circ$&#39;</span>
    <span class="n">x_pts</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]</span>
    <span class="n">y_pts</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">phi</span><span class="p">)]</span>
    <span class="n">ax_plane</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_pts</span><span class="p">,</span> <span class="n">y_pts</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_phi</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax_plane</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax_plane</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">fig_R</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># make the spacing of subplots nicer</span>
</pre></div>
</div>
</div>
</div>
<p>Ok, now we can look at the <span class="math notranslate nohighlight">\(R(\theta,\phi)\)</span> plot and make observations, which we can then try to back-up from the formula. <strong>Try to answer these questions.</strong></p>
<ul class="simple">
<li><p>Can you generalize the argument about symmetry to any <span class="math notranslate nohighlight">\(\phi\)</span>?</p></li>
<li><p>What are the constraints on <span class="math notranslate nohighlight">\(R\)</span> from the figure?  Do they match the formula?</p></li>
<li><p>Do the changes in the curves with increasing <span class="math notranslate nohighlight">\(\phi\)</span> make sense?  Can they be extracted from the formula?</p></li>
</ul>
<p>Now plot the <span class="math notranslate nohighlight">\(R_{max}\)</span> formula. <strong>Evaluate whether it is consistent with the plots of R.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># make a plot of R_max versus phi</span>
<span class="n">fig_Rmax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">num</span><span class="o">=</span><span class="s1">&#39;Taylor 1.39&#39;</span><span class="p">)</span>
<span class="n">ax_Rmax</span> <span class="o">=</span> <span class="n">fig_Rmax</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax_Rmax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Maximum Distance given $\phi$&#39;</span><span class="p">)</span>
<span class="n">ax_Rmax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\phi$ (degrees)&#39;</span><span class="p">)</span>
<span class="n">ax_Rmax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$R_</span><span class="si">{max}</span><span class="s1">$&#39;</span><span class="p">)</span>

<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span><span class="mf">.1</span><span class="p">)</span>
<span class="n">ax_Rmax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rad_to_deg</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> <span class="n">Rmax</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span>

<span class="n">fig_Rmax</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># make the spacing of subplots nicer</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Spotcheck some points on this curve against the previous graph of <span class="math notranslate nohighlight">\(R\)</span>.  What should you compare?</strong></p>
</div>
<div class="section" id="widgetizing-with-ipywidgets-and-interact">
<h2>Widgetizing with ipywidgets and interact<a class="headerlink" href="#widgetizing-with-ipywidgets-and-interact" title="Permalink to this headline">¶</a></h2>
<p>The widgets don’t seem to play well with the notebook back end, so we’ll switch to <code class="docutils literal notranslate"><span class="pre">%matplotlib</span> <span class="pre">inline</span></code>.  You may need to restart the kernel.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">fixed</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="c1"># A simple function evaluation (all in radians at this point).</span>
<span class="n">interact</span><span class="p">(</span><span class="n">Range_R</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">4.</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">g</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="mf">9.8</span><span class="p">));</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_range_R_versus_theta</span><span class="p">(</span><span class="n">phi_deg</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Make a plot of range R versus theta for given phi values in degrees&quot;&quot;&quot;</span>

    <span class="n">phi_rad</span> <span class="o">=</span> <span class="n">deg_to_rad</span><span class="p">(</span><span class="n">phi_deg</span><span class="p">)</span>
    <span class="n">theta_deg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">90.</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">theta_rad</span> <span class="o">=</span> <span class="n">deg_to_rad</span><span class="p">(</span><span class="n">theta_deg</span><span class="p">)</span>
    <span class="n">range_R</span> <span class="o">=</span> <span class="n">Range_R</span><span class="p">(</span><span class="n">theta_rad</span><span class="p">,</span><span class="n">phi_rad</span><span class="p">)</span>
    
    <span class="n">fig_R</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">num</span><span class="o">=</span><span class="s1">&#39;Taylor 1.39&#39;</span><span class="p">)</span>
    <span class="n">ax_R</span> <span class="o">=</span> <span class="n">fig_R</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax_R</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distance to landing&#39;</span><span class="p">)</span>
    <span class="n">ax_R</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\theta$&#39;</span><span class="p">)</span>
    <span class="n">ax_R</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$R(\theta,\phi)$&#39;</span><span class="p">)</span>

    <span class="n">label_phi</span> <span class="o">=</span> <span class="sa">fr</span><span class="s1">&#39;$\phi = </span><span class="si">{</span><span class="n">phi_deg</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">\!^\circ$&#39;</span>
    <span class="n">ax_R</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_deg</span><span class="p">,</span> <span class="n">range_R</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_phi</span><span class="p">)</span>
    <span class="n">ax_R</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1.1</span><span class="o">*</span><span class="n">range_R</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>  <span class="c1"># set limit *after* plotting to get auto-scaling</span>
    <span class="n">ax_R</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">ax_plane</span> <span class="o">=</span> <span class="n">fig_R</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_plane</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Inclined plane&#39;</span><span class="p">)</span>
    <span class="n">ax_plane</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.1</span><span class="p">)</span>
    <span class="n">ax_plane</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.1</span><span class="p">)</span>
    <span class="n">label_phi</span> <span class="o">=</span> <span class="sa">fr</span><span class="s1">&#39;$\phi = </span><span class="si">{</span><span class="n">phi_deg</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">\!^\circ$&#39;</span>
    <span class="n">x_pts</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]</span>
    <span class="n">y_pts</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">phi_rad</span><span class="p">)]</span>
    <span class="n">ax_plane</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_pts</span><span class="p">,</span> <span class="n">y_pts</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_phi</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_plane</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">ax_plane</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
    <span class="n">fig_R</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># make the spacing of subplots nicer</span>

<span class="n">interact</span><span class="p">(</span><span class="n">plot_range_R_versus_theta</span><span class="p">,</span> <span class="n">phi_deg</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">90.</span><span class="p">));</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to avoid the jiggling and do some formatting</span>
<span class="n">phi_deg_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span>
                                     <span class="n">description</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\phi$ in degrees&#39;</span><span class="p">,</span>
                                     <span class="n">readout_format</span><span class="o">=</span><span class="s1">&#39;.0f&#39;</span><span class="p">,</span>
                                     <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span>
                                    <span class="p">)</span>
<span class="n">interact</span><span class="p">(</span><span class="n">plot_range_R_versus_theta</span><span class="p">,</span> <span class="n">phi_deg</span><span class="o">=</span><span class="n">phi_deg_widget</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="ok-how-about-using-sympy">
<h2>Ok, how about using sympy?<a class="headerlink" href="#ok-how-about-using-sympy" title="Permalink to this headline">¶</a></h2>
<p>See if we can reproduce the algebra of solving for final t, x, and y.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sy</span>
<span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;theta phi v0 m g&#39;</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y t&#39;</span><span class="p">)</span>
<span class="n">half</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tf</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">v0</span><span class="o">*</span><span class="n">sy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">half</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">sy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">tf</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">v0</span><span class="o">*</span><span class="n">sy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">half</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">sy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span>
<span class="n">xf</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">tf</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">trigsimp</span><span class="p">(</span><span class="n">xf</span><span class="p">)</span>
<span class="n">R</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">thetamax</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">sy</span><span class="o">.</span><span class="n">trigsimp</span><span class="p">(</span><span class="n">sy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">theta</span><span class="p">)),</span><span class="n">theta</span><span class="p">)</span>
<span class="n">thetamax</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Rmax</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span><span class="n">thetamax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">Rmax</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="ok-now-as-a-differential-equation">
<h2>Ok, now as a differential equation<a class="headerlink" href="#ok-now-as-a-differential-equation" title="Permalink to this headline">¶</a></h2>
<p>We’ll use odeint for simplicity.  Treat it as coupled 2nd-order differential equations for <span class="math notranslate nohighlight">\(x(t)\)</span>, <span class="math notranslate nohighlight">\(y(t)\)</span>, <span class="math notranslate nohighlight">\(v_x(t)\)</span>, and <span class="math notranslate nohighlight">\(v_y(t)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
   \frac{d}{dt}\left(\begin{array}{c}
                          \mathbf{x} \\
                          \mathbf{v}
                      \end{array}\right)
               = \left(\begin{array}{c}
                          \mathbf{v} \\
                          \mathbf{F}/m
                       \end{array}\right)
      \qquad \Longrightarrow \qquad
   \frac{d}{dt}\left(\begin{array}{c}
                          x \\
                          y \\
                          v_x \\
                          v_y
                      \end{array}\right)
               = \left(\begin{array}{c}
                          v_x \\
                          v_y \\
                          F_x/m \\
                          F_y/m
                       \end{array}\right)
\end{align}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ode_rhs</span><span class="p">(</span><span class="n">u_vec</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Right-hand side (rhs) of the differential equation, with </span>
<span class="sd">    u_vec = [x, y, v_x, v_y] and params = [g, phi].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">v_x</span><span class="p">,</span> <span class="n">v_y</span> <span class="o">=</span> <span class="n">u_vec</span>  <span class="c1"># We don&#39;t actually use x or y here, but could!</span>
    <span class="n">g</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">params</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">v_x</span><span class="p">,</span> <span class="n">v_y</span><span class="p">,</span> <span class="o">-</span><span class="n">g</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> <span class="o">-</span><span class="n">g</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="mf">9.8</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">8.</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">4.</span>
<span class="n">v0</span> <span class="o">=</span> <span class="mf">1.</span>

<span class="n">analytic_range</span> <span class="o">=</span> <span class="n">Range_R</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span><span class="n">phi</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">v0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Analytic range = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">analytic_range</span><span class="p">))</span>

<span class="n">u0_vec</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">v0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">v0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)]</span> 

<span class="n">t_max</span> <span class="o">=</span> <span class="mf">1.</span>  <span class="c1"># integration time</span>
<span class="n">t_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>

<span class="c1"># absolute and relative tolerances for ode solver</span>
<span class="n">abserr</span> <span class="o">=</span> <span class="mf">1.0e-8</span>
<span class="n">relerr</span> <span class="o">=</span> <span class="mf">1.0e-6</span>


<span class="c1"># Integrate the differential equation</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">v_x</span><span class="p">,</span> <span class="n">v_y</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">ode_rhs</span><span class="p">,</span> <span class="n">u0_vec</span><span class="p">,</span> <span class="n">t_pts</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">phi</span><span class="p">),</span> 
              <span class="n">atol</span><span class="o">=</span><span class="n">abserr</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">relerr</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<p>We’ll just check one case here, but you can do more!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">.15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">.15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x: distance up incline&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;y: distance $\perp$ to incline&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">analytic_range</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Did it work?</strong></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "furnstahl/5300-JB",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks/Taylor_problems"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../../content/Taylor/Taylor_chapters_1to4.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Taylor Chapters 1 to 4</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Taylor_problem_1.50.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Taylor problem 1.50</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Dick Furnstahl<br/>
        
            &copy; Copyright 2022.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>