
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Multiple pendulum plots. Section 12.4: Approach to Chaos &#8212; Theoretical and computational mechanics</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"N": "\\mathbb{N}", "avec": ["\\boldsymbol{a}"], "floor": ["\\lfloor#1\\rfloor", 1], "bmat": ["\\left[\\begin{array}"], "emat": ["\\end{array}\\right]"]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/5300_icon.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Theoretical and computational mechanics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../about.html">
   About Physics 5300: Theoretical and Computational Mechanics
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Course overview
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../content/Course/overview.html">
   Objectives
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../content/Reference/installing_anaconda.html">
   Using Anaconda
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Reference/python_jupyter.html">
   Python and Jupyter notebooks
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reference/Jupyter_Python_intro_01.html">
     Python and Jupyter notebooks: part 01
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Reference/advanced.html">
   Advanced topics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/Reference/using_github.html">
     Using GitHub
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reference/Jupyter_Python_intro_02.html">
     Python and Jupyter notebooks: part 02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reference/Simple_widgets_v1.html">
     Widgets in Jupyter
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Taylor problem notebooks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Taylor/Taylor_chapters_1to4.html">
   Taylor Chapters 1 to 4
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_1.39.html">
     Taylor problem 1.39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_1.50.html">
     Taylor problem 1.50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_1.50_supplement1.html">
     Taylor problem 1.50 supplement
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_2.20_template.html">
     Taylor problem 2.20 Template
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_2.40_template.html">
     Taylor problem 2.40
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_2.43_template.html">
     Taylor problem 2.43
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_3.23.html">
     Taylor problem 3.23
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_4.29_template.html">
     Taylor problem 4.29 template
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_4.37_template.html">
     Taylor problem 4.37 template
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/Pendulum_widget_visualization_v02.html">
     Pendulum visualization using ipywidgets
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Taylor/Taylor_chapter_5.html">
   Taylor Chapter 5
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_5.2.html">
     Taylor problem 5.2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_5.13.html">
     Taylor problem 5.2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_5.32.html">
     Taylor problem 5.32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_5.36.html">
     Taylor problem 5.36 (with Example 5.3 graphs)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_5.36_atan2.html">
     Taylor problem 5.36 (with Example 5.3 graphs)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_Example_5.5.html">
     Taylor Examples 5.4 and 5.5
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_5.50.html">
     Taylor problem 5.50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/Harmonic_oscillator_visualization_v03.html">
     Harmonic oscillator visualization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/Linear_operator_games.html">
     Demo notebook for linear operators as matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/Fourier_coefficient_intuition_v1.html">
     Fourier coefficient intuition
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Taylor/Taylor_chapter_12.html">
   Taylor Chapter 12
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Multiple_pendulum_plots_Section_12.3.html">
     Multiple pendulum plots: Section 12.3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Multiple_pendulum_plots_Section_12.4.html">
     Multiple pendulum plots. Section 12.4: Approach to Chaos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Multiple_pendulum_plots_Section_12.5.html">
     Multiple pendulum plots. Section 12.5: Chaos and sensitivity to initial conditions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Multiple_pendulum_plots_Section_12.8.html">
     Multiple pendulum plots. Section 12.8: Poincare Sections
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/pendulum_animation_notebook_v2.html">
     Basic pendulum animations: using %matplotlib notebook
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/two_pendulum_animation_v1.html">
     Two pendulum animations (using %matplotlib notebook)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/Logistic_map_explorations.html">
     Logistic map explorations (Taylor and beyond)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/sine_map_explorations_v2.html">
     Sine map explorations (Taylor and beyond)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Taylor/Taylor_chapter_6.html">
   Taylor Chapter 6
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/pendulum_animation_notebook_v3.html">
     Basic pendulum animations: using %matplotlib notebook
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/visualizing_stationary_functional_v1.html">
     Visualizing stationary paths of a  functional
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/Brachistochrone_static_homework.html">
     Brachistochrone problem (static)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/tautochrone_simulation.html">
     Tautochrone simulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reference/ODEs_with_solve_ivp.html">
     Solving ODEs with scipy.integrate.solve_ivp
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reference/Plotting_every_period_and_making_tables.html">
     Plotting every period and printing tables
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reference/test_of_GridSpec.html">
     Test of GridSpec
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="problem_6.12_constants.html">
     Finding constants using fsolve
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Taylor/Taylor_chapter_7.html">
   Taylor Chapter 7
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Multiple_pendulum_plots_solutions_new_solver.html">
     Multiple pendulum plots solutions to problems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Taylor/Taylor_chapter_8.html">
   Taylor Chapter 8
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reference/Demo_of_subclasses_nonphysics.html">
     Non-physics example of using Python subclasses
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reference/MyVector_class_and_MyPolarVector_subclass.html">
     Example of class and subclass
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Energy_diagrams_Taylor_examples_8p1_8p2.html">
     Taylor examples 8.1 and 8.2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/Orbit_games.html">
     Orbit games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reference/Orbital_eqs_with_different_algorithms.html">
     Solving orbital equations with different algorithms
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Taylor/Taylor_chapter_11.html">
   Taylor Chapter 11
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/CoupledOscillators_games_v4.html">
     Playing with coupled oscillators - v3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_7.42_solution.html">
     Taylor problem 7.42
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Taylor/Taylor_chapter_13.html">
   Taylor Chapter 13
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/Lagrangian_pendulum.html">
     Simple pendulum using Lagrange’s equation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Taylor/Taylor_chapter_16.html">
   Taylor Chapter 16
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reference/wave_animation_1.html">
     Animating a simple wave
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_16p14_A.html">
     Taylor Problem 16.14 version A
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_16p14_B.html">
     Taylor Problem 16.14 version B
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_16p14_finite_difference_template.html">
     Taylor Problem 16.14 version finite difference
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reference material
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../content/zbibliography.html">
   Bibliography
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/notebooks/Taylor_problems/Multiple_pendulum_plots_Section_12.4-Copy1.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/furnstahl/5300-JB"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/furnstahl/5300-JB/issues/new?title=Issue%20on%20page%20%2Fnotebooks/Taylor_problems/Multiple_pendulum_plots_Section_12.4-Copy1.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/furnstahl/5300-JB/main?urlpath=tree/./notebooks/Taylor_problems/Multiple_pendulum_plots_Section_12.4-Copy1.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pendulum-class-and-utility-functions">
   Pendulum class and utility functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-plots-for-taylor-figure-12-4">
   Make plots for Taylor Figure 12.4
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#figure-12-5-pick-conditions-and-then-analyze">
   Figure 12.5: Pick conditions and then analyze
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-plots-for-taylor-figure-12-6">
   Make plots for Taylor Figure 12.6
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-plots-for-taylor-figure-12-7">
   Make plots for Taylor Figure 12.7
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-plots-for-taylor-figure-12-8">
   Make plots for Taylor Figure 12.8
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="multiple-pendulum-plots-section-12-4-approach-to-chaos">
<h1>Multiple pendulum plots. Section 12.4: Approach to Chaos<a class="headerlink" href="#multiple-pendulum-plots-section-12-4-approach-to-chaos" title="Permalink to this headline">¶</a></h1>
<p>Use Pendulum class to generate basic pendulum plots.  Applied here to figures from Taylor Section 12.4.</p>
<ul class="simple">
<li><p>Last revised 23-Jan-2019 by Dick Furnstahl (<a class="reference external" href="mailto:furnstahl&#46;1&#37;&#52;&#48;osu&#46;edu">furnstahl<span>&#46;</span>1<span>&#64;</span>osu<span>&#46;</span>edu</a>).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="pendulum-class-and-utility-functions">
<h2>Pendulum class and utility functions<a class="headerlink" href="#pendulum-class-and-utility-functions" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Pendulum</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Pendulum class implements the parameters and differential equation for </span>
<span class="sd">     a pendulum using the notation from Taylor.</span>
<span class="sd">     </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    omega_0 : float</span>
<span class="sd">        natural frequency of the pendulum (\sqrt{g/l} where l is the </span>
<span class="sd">        pendulum length) </span>
<span class="sd">    beta : float</span>
<span class="sd">        coefficient of friction </span>
<span class="sd">    gamma_ext : float</span>
<span class="sd">        amplitude of external force is gamma * omega_0**2 </span>
<span class="sd">    omega_ext : float</span>
<span class="sd">        frequency of external force </span>
<span class="sd">    phi_ext : float</span>
<span class="sd">        phase angle for external force </span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    dy_dt(y, t)</span>
<span class="sd">        Returns the right side of the differential equation in vector y, </span>
<span class="sd">        given time t and the corresponding value of y.</span>
<span class="sd">    driving_force(t) </span>
<span class="sd">        Returns the value of the external driving force at time t.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">omega_0</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                 <span class="n">gamma_ext</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">omega_ext</span><span class="o">=</span><span class="mf">0.689</span><span class="p">,</span> <span class="n">phi_ext</span><span class="o">=</span><span class="mf">0.</span>
                <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">omega_0</span> <span class="o">=</span> <span class="n">omega_0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="n">beta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma_ext</span> <span class="o">=</span> <span class="n">gamma_ext</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">omega_ext</span> <span class="o">=</span> <span class="n">omega_ext</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phi_ext</span> <span class="o">=</span> <span class="n">phi_ext</span>
    
    <span class="k">def</span> <span class="nf">dy_dt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function returns the right-hand side of the diffeq: </span>
<span class="sd">        [dphi/dt d^2phi/dt^2]</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        y : float</span>
<span class="sd">            A 2-component vector with y[0] = phi(t) and y[1] = dphi/dt</span>
<span class="sd">        t : float</span>
<span class="sd">            time </span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">F_ext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">driving_force</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">omega_0</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mf">2.</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> \
                       <span class="o">+</span> <span class="n">F_ext</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">driving_force</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function returns the value of the driving force at time t.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma_ext</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega_0</span><span class="o">**</span><span class="mi">2</span> \
                              <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">omega_ext</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi_ext</span><span class="p">)</span>  
    
    <span class="k">def</span> <span class="nf">solve_ode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phi_0</span><span class="p">,</span> <span class="n">phi_dot_0</span><span class="p">,</span> <span class="n">abserr</span><span class="o">=</span><span class="mf">1.0e-8</span><span class="p">,</span> <span class="n">relerr</span><span class="o">=</span><span class="mf">1.0e-6</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Solve the ODE given initial conditions.</span>
<span class="sd">        For now use odeint, but we have the option to switch.</span>
<span class="sd">        Specify smaller abserr and relerr to get more precision.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">phi_0</span><span class="p">,</span> <span class="n">phi_dot_0</span><span class="p">]</span>  
        <span class="n">phi</span><span class="p">,</span> <span class="n">phi_dot</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dy_dt</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t_pts</span><span class="p">,</span> 
                              <span class="n">atol</span><span class="o">=</span><span class="n">abserr</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">relerr</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="k">return</span> <span class="n">phi</span><span class="p">,</span> <span class="n">phi_dot</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_y_vs_x</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">axis_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">semilogy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loglog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generic plotting function: return a figure axis with a plot of y vs. x,</span>
<span class="sd">    with line color and style, title, axis labels, and line label</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>        <span class="c1"># if the axis object doesn&#39;t exist, make one</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">semilogy</span><span class="p">):</span>
        <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> 
                            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">)</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">loglog</span><span class="p">):</span>
        <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> 
                          <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> 
                    <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>    <span class="c1"># if a label if passed, show the legend</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>    <span class="c1"># set a title if one if passed</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">axis_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># set x-axis and y-axis labels if passed  </span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">axis_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">axis_labels</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">ax</span><span class="p">,</span> <span class="n">line</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="n">plot_start</span><span class="p">,</span> <span class="n">plot_stop</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Given an array (e.g., of times) and desired starting and stop values,</span>
<span class="sd">        return the array indices that are closest to those values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">t_pts</span><span class="o">-</span><span class="n">plot_start</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>  <span class="c1"># index in t_pts array </span>
    <span class="n">stop_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">t_pts</span><span class="o">-</span><span class="n">plot_stop</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>  <span class="c1"># index in t_pts array </span>
    <span class="k">return</span> <span class="n">start_index</span><span class="p">,</span> <span class="n">stop_index</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="make-plots-for-taylor-figure-12-4">
<h2>Make plots for Taylor Figure 12.4<a class="headerlink" href="#make-plots-for-taylor-figure-12-4" title="Permalink to this headline">¶</a></h2>
<p>We’ll set it up with the specified parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Labels for individual plot axes</span>
<span class="n">phi_vs_time_labels</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\phi(t)$&#39;</span><span class="p">)</span>
<span class="n">phi_dot_vs_time_labels</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$d\phi/dt(t)$&#39;</span><span class="p">)</span>
<span class="n">state_space_labels</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\phi$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$d\phi/dt$&#39;</span><span class="p">)</span>

<span class="c1"># Common plotting time (generate the full time then use slices)</span>
<span class="n">t_start</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">t_end</span> <span class="o">=</span> <span class="mf">100.</span>
<span class="n">delta_t</span> <span class="o">=</span> <span class="mf">0.01</span>

<span class="n">t_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span><span class="o">+</span><span class="n">delta_t</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">)</span>  

<span class="c1"># Common pendulum parameters</span>
<span class="n">gamma_ext</span> <span class="o">=</span> <span class="mf">1.06</span>
<span class="n">omega_ext</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">phi_ext</span> <span class="o">=</span> <span class="mf">0.</span>

<span class="n">omega_0</span> <span class="o">=</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">omega_ext</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">omega_0</span><span class="o">/</span><span class="mf">4.</span>

<span class="c1"># Instantiate a pendulum </span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">Pendulum</span><span class="p">(</span><span class="n">omega_0</span><span class="o">=</span><span class="n">omega_0</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span> 
              <span class="n">gamma_ext</span><span class="o">=</span><span class="n">gamma_ext</span><span class="p">,</span> <span class="n">omega_ext</span><span class="o">=</span><span class="n">omega_ext</span><span class="p">,</span> <span class="n">phi_ext</span><span class="o">=</span><span class="n">phi_ext</span><span class="p">)</span>

<span class="c1"># calculate the driving force for t_pts</span>
<span class="n">driving</span> <span class="o">=</span> <span class="n">p1</span><span class="o">.</span><span class="n">driving_force</span><span class="p">(</span><span class="n">t_pts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># initial conditions specified</span>
<span class="n">phi_0</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">phi_dot_0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">phi</span><span class="p">,</span> <span class="n">phi_dot</span> <span class="o">=</span> <span class="n">p1</span><span class="o">.</span><span class="n">solve_ode</span><span class="p">(</span><span class="n">phi_0</span><span class="p">,</span> <span class="n">phi_dot_0</span><span class="p">)</span>

<span class="c1"># Change the common font size</span>
<span class="n">font_size</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="n">font_size</span><span class="p">})</span>

<span class="c1"># start the plot!</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">overall_title</span> <span class="o">=</span> <span class="s1">&#39;Taylor Figure 12.4:  &#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\omega = </span><span class="si">{</span><span class="n">omega_ext</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">,$&#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\gamma = </span><span class="si">{</span><span class="n">gamma_ext</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">,$&#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\omega_0 = </span><span class="si">{</span><span class="n">omega_0</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">,$&#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\beta = </span><span class="si">{</span><span class="n">beta</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">,$&#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39;  $\phi_0 = </span><span class="si">{</span><span class="n">phi_0</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">,$&#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\dot\phi_0 = </span><span class="si">{</span><span class="n">phi_dot_0</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">$&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>     <span class="c1"># \n means a new line (adds some space here)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">overall_title</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">)</span>
    
<span class="c1"># first plot: plot from t=0 to t=15   </span>
<span class="n">ax_a</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>                  

<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">15.</span><span class="p">)</span>    
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">t_pts</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> <span class="n">phi</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="n">phi_vs_time_labels</span><span class="p">,</span> 
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Figure 12.4&#39;</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_a</span><span class="p">)</span>    
                              
<span class="c1"># second plot: state space plot from t=0 to t=15   </span>
<span class="n">ax_b</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>                  

<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">15.</span><span class="p">)</span>    
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> <span class="n">phi_dot</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="n">state_space_labels</span><span class="p">,</span> 
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span><span class="o">=</span><span class="sa">rf</span><span class="s1">&#39;$0 \leq t \leq 15$&#39;</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_b</span><span class="p">)</span>    

<span class="c1"># third plot: state space plot from t= to t=12   </span>
<span class="n">ax_c</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>                  

<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">30.</span><span class="p">)</span>    
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> <span class="n">phi_dot</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="n">state_space_labels</span><span class="p">,</span> 
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span><span class="o">=</span><span class="sa">rf</span><span class="s1">&#39;$10 \leq t \leq 30$&#39;</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_c</span><span class="p">)</span>    

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;Figure_12.4.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>  <span class="c1"># always bbox_inches=&#39;tight&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Multiple_pendulum_plots_Section_12.4-Copy1_9_0.png" src="../../_images/Multiple_pendulum_plots_Section_12.4-Copy1_9_0.png" />
</div>
</div>
<p>Let’s check for periodicity after the transients die out.  Print out phi(t) once every period of the external driving force.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First pass at periodicity check</span>
<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">50.</span><span class="p">,</span> <span class="mf">70.</span><span class="p">)</span>    
<span class="n">tau_ext</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">omega_ext</span>
<span class="n">delta_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tau_ext</span> <span class="o">/</span> <span class="n">delta_t</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;   t     phi(t)&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">delta_index</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;  </span><span class="si">{</span><span class="n">t_pts</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">   </span><span class="si">{</span><span class="n">phi</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   t     phi(t)
  50.0   6.0366
  51.0   6.0367
  52.0   6.0366
  53.0   6.0366
  54.0   6.0366
  55.0   6.0366
  56.0   6.0366
  57.0   6.0367
  58.0   6.0366
  59.0   6.0366
  60.0   6.0366
  61.0   6.0366
  62.0   6.0366
  63.0   6.0366
  64.0   6.0366
  65.0   6.0366
  66.0   6.0366
  67.0   6.0366
  68.0   6.0366
  69.0   6.0366
</pre></div>
</div>
</div>
</div>
<p>Now trying the power spectrum in steady state, plotting only positive frequencies and cutting off any lower peaks from noise.  We multiply the frequencies by <span class="math notranslate nohighlight">\(2\pi\)</span> to get the angular frequency.  <strong>What do you observe?</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">20.</span><span class="p">,</span> <span class="n">t_end</span><span class="p">)</span>    
<span class="n">signal</span> <span class="o">=</span> <span class="n">phi</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
<span class="n">power_spectrum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">freqs</span><span class="p">)</span>

<span class="n">fig_ps</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax_ps</span> <span class="o">=</span> <span class="n">fig_ps</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax_ps</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">freqs</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">power_spectrum</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax_ps</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">30.</span><span class="p">)</span>
<span class="n">ax_ps</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1.e4</span><span class="p">,</span> <span class="mf">1.e9</span><span class="p">)</span>
<span class="n">ax_ps</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">ax_ps</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Power Spectrum for Figure 12.4&#39;</span><span class="p">)</span>

<span class="n">fig_ps</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Multiple_pendulum_plots_Section_12.4-Copy1_13_0.png" src="../../_images/Multiple_pendulum_plots_Section_12.4-Copy1_13_0.png" />
</div>
</div>
</div>
<div class="section" id="figure-12-5-pick-conditions-and-then-analyze">
<h2>Figure 12.5: Pick conditions and then analyze<a class="headerlink" href="#figure-12-5-pick-conditions-and-then-analyze" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Labels for individual plot axes</span>
<span class="n">phi_vs_time_labels</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\phi(t)$&#39;</span><span class="p">)</span>
<span class="n">phi_dot_vs_time_labels</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$d\phi/dt(t)$&#39;</span><span class="p">)</span>
<span class="n">state_space_labels</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\phi$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$d\phi/dt$&#39;</span><span class="p">)</span>

<span class="c1"># Common plotting time (generate the full time then use slices)</span>
<span class="n">t_start</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">t_end</span> <span class="o">=</span> <span class="mf">100.</span>
<span class="n">delta_t</span> <span class="o">=</span> <span class="mf">0.01</span>

<span class="n">t_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span><span class="o">+</span><span class="n">delta_t</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">)</span>  

<span class="c1"># Common pendulum parameters</span>
<span class="n">gamma_ext</span> <span class="o">=</span> <span class="mf">1.073</span>   
<span class="n">omega_ext</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">phi_ext</span> <span class="o">=</span> <span class="mf">0.</span>  

<span class="n">omega_0</span> <span class="o">=</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">omega_ext</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">omega_0</span><span class="o">/</span><span class="mf">4.</span>  

<span class="c1"># Instantiate a pendulum </span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">Pendulum</span><span class="p">(</span><span class="n">omega_0</span><span class="o">=</span><span class="n">omega_0</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span> 
              <span class="n">gamma_ext</span><span class="o">=</span><span class="n">gamma_ext</span><span class="p">,</span> <span class="n">omega_ext</span><span class="o">=</span><span class="n">omega_ext</span><span class="p">,</span> <span class="n">phi_ext</span><span class="o">=</span><span class="n">phi_ext</span><span class="p">)</span>

<span class="c1"># calculate the driving force for t_pts</span>
<span class="n">driving</span> <span class="o">=</span> <span class="n">p1</span><span class="o">.</span><span class="n">driving_force</span><span class="p">(</span><span class="n">t_pts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># initial conditions specified</span>
<span class="n">phi_0</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">phi_dot_0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">phi</span><span class="p">,</span> <span class="n">phi_dot</span> <span class="o">=</span> <span class="n">p1</span><span class="o">.</span><span class="n">solve_ode</span><span class="p">(</span><span class="n">phi_0</span><span class="p">,</span> <span class="n">phi_dot_0</span><span class="p">)</span>

<span class="c1"># Change the common font size</span>
<span class="n">font_size</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="n">font_size</span><span class="p">})</span>

<span class="c1"># start the plot!</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">overall_title</span> <span class="o">=</span> <span class="s1">&#39;Taylor Figure 12.5:  &#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\omega = </span><span class="si">{</span><span class="n">omega_ext</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">,$&#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\gamma = </span><span class="si">{</span><span class="n">gamma_ext</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">,$&#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\omega_0 = </span><span class="si">{</span><span class="n">omega_0</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">,$&#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\beta = </span><span class="si">{</span><span class="n">beta</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">,$&#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39;  $\phi_0 = </span><span class="si">{</span><span class="n">phi_0</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">,$&#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\dot\phi_0 = </span><span class="si">{</span><span class="n">phi_dot_0</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">$&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>     <span class="c1"># \n means a new line (adds some space here)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">overall_title</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">)</span>
    
<span class="c1"># first plot: plot from t=0 to t=15   </span>
<span class="n">ax_a</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>                  

<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">30.</span><span class="p">)</span>    
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">t_pts</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> <span class="n">phi</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="n">phi_vs_time_labels</span><span class="p">,</span> 
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Figure 12.5&#39;</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_a</span><span class="p">)</span>    
                              
<span class="c1"># second plot: state space plot from t=0 to t=15   </span>
<span class="n">ax_b</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>                  

<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">15.</span><span class="p">)</span>    
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> <span class="n">phi_dot</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="n">state_space_labels</span><span class="p">,</span> 
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span><span class="o">=</span><span class="sa">rf</span><span class="s1">&#39;$0 \leq t \leq 15$&#39;</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_b</span><span class="p">)</span>    

<span class="c1"># third plot: state space plot from t= to t=12   </span>
<span class="n">ax_c</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>                  

<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">30.</span><span class="p">,</span> <span class="mf">50.</span><span class="p">)</span>    
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> <span class="n">phi_dot</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="n">state_space_labels</span><span class="p">,</span> 
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span><span class="o">=</span><span class="sa">rf</span><span class="s1">&#39;$30 \leq t \leq 50$&#39;</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_c</span><span class="p">)</span>    

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;Figure_12.5.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>  <span class="c1"># always bbox_inches=&#39;tight&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Multiple_pendulum_plots_Section_12.4-Copy1_16_0.png" src="../../_images/Multiple_pendulum_plots_Section_12.4-Copy1_16_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First pass at periodicity check</span>
<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">50.</span><span class="p">,</span> <span class="mf">70.</span><span class="p">)</span>    
<span class="n">tau_ext</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">omega_ext</span>
<span class="n">delta_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tau_ext</span> <span class="o">/</span> <span class="n">delta_t</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;   t     phi(t)&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">delta_index</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;  </span><span class="si">{</span><span class="n">t_pts</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">   </span><span class="si">{</span><span class="n">phi</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   t     phi(t)
  50.0   -6.6438
  51.0   -6.4090
  52.0   -6.6438
  53.0   -6.4090
  54.0   -6.6438
  55.0   -6.4090
  56.0   -6.6437
  57.0   -6.4090
  58.0   -6.6438
  59.0   -6.4090
  60.0   -6.6437
  61.0   -6.4090
  62.0   -6.6438
  63.0   -6.4090
  64.0   -6.6438
  65.0   -6.4090
  66.0   -6.6439
  67.0   -6.4090
  68.0   -6.6439
  69.0   -6.4090
</pre></div>
</div>
</div>
</div>
<p>Now trying the power spectrum in steady state, plotting only positive frequencies and cutting off any lower peaks from noise.  We multiply the frequencies by <span class="math notranslate nohighlight">\(2\pi\)</span> to get the angular frequency.  <strong>What do you observe?</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">20.</span><span class="p">,</span> <span class="n">t_end</span><span class="p">)</span>    
<span class="n">signal</span> <span class="o">=</span> <span class="n">phi</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
<span class="n">power_spectrum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">freqs</span><span class="p">)</span>

<span class="n">fig_ps</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax_ps</span> <span class="o">=</span> <span class="n">fig_ps</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax_ps</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">freqs</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">power_spectrum</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax_ps</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">30.</span><span class="p">)</span>
<span class="n">ax_ps</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1.e4</span><span class="p">,</span> <span class="mf">1.e9</span><span class="p">)</span>
<span class="n">ax_ps</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">ax_ps</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Power Spectrum for Figure 12.5&#39;</span><span class="p">)</span>

<span class="n">fig_ps</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Multiple_pendulum_plots_Section_12.4-Copy1_19_0.png" src="../../_images/Multiple_pendulum_plots_Section_12.4-Copy1_19_0.png" />
</div>
</div>
</div>
<div class="section" id="make-plots-for-taylor-figure-12-6">
<h2>Make plots for Taylor Figure 12.6<a class="headerlink" href="#make-plots-for-taylor-figure-12-6" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Labels for individual plot axes</span>
<span class="n">phi_vs_time_labels</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\phi(t)$&#39;</span><span class="p">)</span>
<span class="n">phi_dot_vs_time_labels</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$d\phi/dt(t)$&#39;</span><span class="p">)</span>
<span class="n">state_space_labels</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\phi$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$d\phi/dt$&#39;</span><span class="p">)</span>

<span class="c1"># Common plotting time (generate the full time then use slices)</span>
<span class="n">t_start</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">t_end</span> <span class="o">=</span> <span class="mf">100.</span>
<span class="n">delta_t</span> <span class="o">=</span> <span class="mf">0.01</span>

<span class="n">t_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span><span class="o">+</span><span class="n">delta_t</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">)</span>  

<span class="c1"># Common pendulum parameters</span>
<span class="n">gamma_ext</span> <span class="o">=</span> <span class="mf">1.077</span>
<span class="n">omega_ext</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">phi_ext</span> <span class="o">=</span> <span class="mf">0.</span>

<span class="n">omega_0</span> <span class="o">=</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">omega_ext</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">omega_0</span><span class="o">/</span><span class="mf">4.</span>

<span class="c1"># Instantiate a pendulum </span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">Pendulum</span><span class="p">(</span><span class="n">omega_0</span><span class="o">=</span><span class="n">omega_0</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span> 
              <span class="n">gamma_ext</span><span class="o">=</span><span class="n">gamma_ext</span><span class="p">,</span> <span class="n">omega_ext</span><span class="o">=</span><span class="n">omega_ext</span><span class="p">,</span> <span class="n">phi_ext</span><span class="o">=</span><span class="n">phi_ext</span><span class="p">)</span>

<span class="c1"># calculate the driving force for t_pts</span>
<span class="n">driving</span> <span class="o">=</span> <span class="n">p1</span><span class="o">.</span><span class="n">driving_force</span><span class="p">(</span><span class="n">t_pts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># initial conditions specified</span>
<span class="n">phi_0</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">phi_dot_0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">phi</span><span class="p">,</span> <span class="n">phi_dot</span> <span class="o">=</span> <span class="n">p1</span><span class="o">.</span><span class="n">solve_ode</span><span class="p">(</span><span class="n">phi_0</span><span class="p">,</span> <span class="n">phi_dot_0</span><span class="p">)</span>
<span class="n">phi_fig12_6</span> <span class="o">=</span> <span class="n">phi</span>

<span class="c1"># Change the common font size</span>
<span class="n">font_size</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="n">font_size</span><span class="p">})</span>

<span class="c1"># start the plot!</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">overall_title</span> <span class="o">=</span> <span class="s1">&#39;Taylor Figure 12.6:  &#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\omega = </span><span class="si">{</span><span class="n">omega_ext</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">,$&#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\gamma = </span><span class="si">{</span><span class="n">gamma_ext</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">,$&#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\omega_0 = </span><span class="si">{</span><span class="n">omega_0</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">,$&#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\beta = </span><span class="si">{</span><span class="n">beta</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">,$&#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39;  $\phi_0 = </span><span class="si">{</span><span class="n">phi_0</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">,$&#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\dot\phi_0 = </span><span class="si">{</span><span class="n">phi_dot_0</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">$&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>     <span class="c1"># \n means a new line (adds some space here)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">overall_title</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">)</span>
    
<span class="c1"># first plot: plot from t=0 to t=10   </span>
<span class="n">ax_a</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>                  

<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">)</span>    
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">t_pts</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> <span class="n">phi</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="n">phi_vs_time_labels</span><span class="p">,</span> 
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;(a)&#39;</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_a</span><span class="p">)</span>    
                              
<span class="c1"># second plot: state space plot from t=0 to t=10   </span>
<span class="n">ax_b</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>                  

<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">15.</span><span class="p">)</span>    
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> <span class="n">phi_dot</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="n">state_space_labels</span><span class="p">,</span> 
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span><span class="o">=</span><span class="sa">rf</span><span class="s1">&#39;$0 \leq t \leq 10$&#39;</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_b</span><span class="p">)</span>    

<span class="c1"># third plot: state space plot from t=5 to t=12   </span>
<span class="n">ax_c</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>                  

<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">100.</span><span class="p">)</span>    
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> <span class="n">phi_dot</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="n">state_space_labels</span><span class="p">,</span> 
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span><span class="o">=</span><span class="sa">rf</span><span class="s1">&#39;$5 \leq t \leq 12$&#39;</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_c</span><span class="p">)</span>    

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;Figure_12.6.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>  <span class="c1"># always bbox_inches=&#39;tight&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Multiple_pendulum_plots_Section_12.4-Copy1_22_0.png" src="../../_images/Multiple_pendulum_plots_Section_12.4-Copy1_22_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First pass at periodicity check</span>
<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">50.</span><span class="p">,</span> <span class="mf">70.</span><span class="p">)</span>    
<span class="n">tau_ext</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">omega_ext</span>
<span class="n">delta_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tau_ext</span> <span class="o">/</span> <span class="n">delta_t</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;   t     phi(t)&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">delta_index</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;  </span><span class="si">{</span><span class="n">t_pts</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">   </span><span class="si">{</span><span class="n">phi</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   t     phi(t)
  50.0   6.8727
  51.0   13.8123
  52.0   7.7586
  53.0   6.8726
  54.0   13.8123
  55.0   7.7586
  56.0   6.8726
  57.0   13.8123
  58.0   7.7586
  59.0   6.8726
  60.0   13.8123
  61.0   7.7586
  62.0   6.8725
  63.0   13.8123
  64.0   7.7586
  65.0   6.8726
  66.0   13.8123
  67.0   7.7586
  68.0   6.8726
  69.0   13.8123
</pre></div>
</div>
</div>
</div>
<p>Now trying the power spectrum in steady state, plotting only positive frequencies and cutting off any lower peaks from noise.  We multiply the frequencies by <span class="math notranslate nohighlight">\(2\pi\)</span> to get the angular frequency.  <strong>What do you observe?</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">20.</span><span class="p">,</span> <span class="n">t_end</span><span class="p">)</span>    
<span class="n">signal</span> <span class="o">=</span> <span class="n">phi</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
<span class="n">power_spectrum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">freqs</span><span class="p">)</span>

<span class="n">fig_ps</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax_ps</span> <span class="o">=</span> <span class="n">fig_ps</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax_ps</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">freqs</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">power_spectrum</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax_ps</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">30.</span><span class="p">)</span>
<span class="n">ax_ps</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1.e3</span><span class="p">,</span> <span class="mf">1.e9</span><span class="p">)</span>
<span class="n">ax_ps</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">ax_ps</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Power Spectrum for Figure 12.6&#39;</span><span class="p">)</span>

<span class="n">fig_ps</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Multiple_pendulum_plots_Section_12.4-Copy1_25_0.png" src="../../_images/Multiple_pendulum_plots_Section_12.4-Copy1_25_0.png" />
</div>
</div>
</div>
<div class="section" id="make-plots-for-taylor-figure-12-7">
<h2>Make plots for Taylor Figure 12.7<a class="headerlink" href="#make-plots-for-taylor-figure-12-7" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Labels for individual plot axes</span>
<span class="n">phi_vs_time_labels</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\phi(t)$&#39;</span><span class="p">)</span>
<span class="n">phi_dot_vs_time_labels</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$d\phi/dt(t)$&#39;</span><span class="p">)</span>
<span class="n">state_space_labels</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\phi$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$d\phi/dt$&#39;</span><span class="p">)</span>

<span class="c1"># Common plotting time (generate the full time then use slices)</span>
<span class="n">t_start</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">t_end</span> <span class="o">=</span> <span class="mf">500.</span>
<span class="n">delta_t</span> <span class="o">=</span> <span class="mf">0.01</span>

<span class="n">t_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span><span class="o">+</span><span class="n">delta_t</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">)</span>  

<span class="c1"># Common pendulum parameters</span>
<span class="n">gamma_ext</span> <span class="o">=</span> <span class="mf">1.077</span>
<span class="n">omega_ext</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">phi_ext</span> <span class="o">=</span> <span class="mf">0.</span>

<span class="n">omega_0</span> <span class="o">=</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">omega_ext</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">omega_0</span><span class="o">/</span><span class="mf">4.</span>

<span class="c1"># Instantiate a pendulum </span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">Pendulum</span><span class="p">(</span><span class="n">omega_0</span><span class="o">=</span><span class="n">omega_0</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span> 
              <span class="n">gamma_ext</span><span class="o">=</span><span class="n">gamma_ext</span><span class="p">,</span> <span class="n">omega_ext</span><span class="o">=</span><span class="n">omega_ext</span><span class="p">,</span> <span class="n">phi_ext</span><span class="o">=</span><span class="n">phi_ext</span><span class="p">)</span>

<span class="c1"># calculate the driving force for t_pts</span>
<span class="n">driving</span> <span class="o">=</span> <span class="n">p1</span><span class="o">.</span><span class="n">driving_force</span><span class="p">(</span><span class="n">t_pts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># initial conditions specified</span>
<span class="n">phi_0</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span>
<span class="n">phi_dot_0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">phi</span><span class="p">,</span> <span class="n">phi_dot</span> <span class="o">=</span> <span class="n">p1</span><span class="o">.</span><span class="n">solve_ode</span><span class="p">(</span><span class="n">phi_0</span><span class="p">,</span> <span class="n">phi_dot_0</span><span class="p">)</span>

<span class="c1"># Change the common font size</span>
<span class="n">font_size</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="n">font_size</span><span class="p">})</span>

<span class="c1"># start the plot!</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">overall_title</span> <span class="o">=</span> <span class="s1">&#39;Taylor Figure 12.7:  &#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\omega = </span><span class="si">{</span><span class="n">omega_ext</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">,$&#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\gamma = </span><span class="si">{</span><span class="n">gamma_ext</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">,$&#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\omega_0 = </span><span class="si">{</span><span class="n">omega_0</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">,$&#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\beta = </span><span class="si">{</span><span class="n">beta</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">,$&#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39;  $\phi_0 = </span><span class="si">{</span><span class="n">phi_0</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">,$&#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\dot\phi_0 = </span><span class="si">{</span><span class="n">phi_dot_0</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">$&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>     <span class="c1"># \n means a new line (adds some space here)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">overall_title</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">)</span>
    
<span class="c1"># first plot: plot from t=0 to t=10   </span>
<span class="n">ax_a</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>                  

<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">)</span>    
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">t_pts</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> <span class="n">phi</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="n">phi_vs_time_labels</span><span class="p">,</span> 
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;(a)&#39;</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_a</span><span class="p">)</span>    
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">t_pts</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> <span class="n">phi_fig12_6</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="n">phi_vs_time_labels</span><span class="p">,</span> 
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_a</span><span class="p">)</span>    
                              
<span class="c1"># second plot: state space plot from t=0 to t=15   </span>
<span class="n">ax_b</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>                  

<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">15.</span><span class="p">)</span>    
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> <span class="n">phi_dot</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="n">state_space_labels</span><span class="p">,</span> 
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span><span class="o">=</span><span class="sa">rf</span><span class="s1">&#39;$0 \leq t \leq 10$&#39;</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_b</span><span class="p">)</span>    

<span class="c1"># third plot: state space plot from t=5 to t=12   </span>
<span class="n">ax_c</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>                  

<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">100.</span><span class="p">)</span>    
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> <span class="n">phi_dot</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="n">state_space_labels</span><span class="p">,</span> 
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span><span class="o">=</span><span class="sa">rf</span><span class="s1">&#39;$5 \leq t \leq 12$&#39;</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_c</span><span class="p">)</span>    

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;Figure_12.7.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>  <span class="c1"># always bbox_inches=&#39;tight&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Multiple_pendulum_plots_Section_12.4-Copy1_29_0.png" src="../../_images/Multiple_pendulum_plots_Section_12.4-Copy1_29_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First pass at periodicity check</span>
<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">50.</span><span class="p">,</span> <span class="mf">70.</span><span class="p">)</span>    
<span class="n">tau_ext</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">omega_ext</span>
<span class="n">delta_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tau_ext</span> <span class="o">/</span> <span class="n">delta_t</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;   t     phi(t)&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">delta_index</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;  </span><span class="si">{</span><span class="n">t_pts</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">   </span><span class="si">{</span><span class="n">phi</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   t     phi(t)
  50.0   -0.1071
  51.0   -0.4051
  52.0   -0.1071
  53.0   -0.4049
  54.0   -0.1071
  55.0   -0.4051
  56.0   -0.1071
  57.0   -0.4049
  58.0   -0.1071
  59.0   -0.4050
  60.0   -0.1071
  61.0   -0.4051
  62.0   -0.1071
  63.0   -0.4049
  64.0   -0.1071
  65.0   -0.4052
  66.0   -0.1071
  67.0   -0.4049
  68.0   -0.1071
  69.0   -0.4050
</pre></div>
</div>
</div>
</div>
<p>Now trying the power spectrum in steady state, plotting only positive frequencies and cutting off any lower peaks from noise.  We multiply the frequencies by <span class="math notranslate nohighlight">\(2\pi\)</span> to get the angular frequency.  <strong>What do you observe?</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">20.</span><span class="p">,</span> <span class="n">t_end</span><span class="p">)</span>    
<span class="n">signal</span> <span class="o">=</span> <span class="n">phi</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
<span class="n">power_spectrum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">freqs</span><span class="p">)</span>

<span class="n">fig_ps</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax_ps</span> <span class="o">=</span> <span class="n">fig_ps</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax_ps</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">freqs</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">power_spectrum</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax_ps</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">30.</span><span class="p">)</span>
<span class="n">ax_ps</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1.e3</span><span class="p">,</span> <span class="mf">1.e10</span><span class="p">)</span>
<span class="n">ax_ps</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">ax_ps</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Power Spectrum for Figure 12.7&#39;</span><span class="p">)</span>

<span class="n">fig_ps</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Multiple_pendulum_plots_Section_12.4-Copy1_32_0.png" src="../../_images/Multiple_pendulum_plots_Section_12.4-Copy1_32_0.png" />
</div>
</div>
</div>
<div class="section" id="make-plots-for-taylor-figure-12-8">
<h2>Make plots for Taylor Figure 12.8<a class="headerlink" href="#make-plots-for-taylor-figure-12-8" title="Permalink to this headline">¶</a></h2>
<p>Now we try to plot a period doubling cascade as in Figure 12.8.  This will mean plots of four different conditions, each with two plots.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Labels for individual plot axes</span>
<span class="n">phi_vs_time_labels</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\phi(t)$&#39;</span><span class="p">)</span>
<span class="n">phi_dot_vs_time_labels</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$d\phi/dt(t)$&#39;</span><span class="p">)</span>
<span class="n">state_space_labels</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\phi$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$d\phi/dt$&#39;</span><span class="p">)</span>

<span class="c1"># Common plotting time (generate the full time then use slices)</span>
<span class="n">t_start</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">t_end</span> <span class="o">=</span> <span class="mf">100.</span>
<span class="n">delta_t</span> <span class="o">=</span> <span class="mf">0.01</span>

<span class="n">t_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span><span class="o">+</span><span class="n">delta_t</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">)</span>  

<span class="c1"># Common parameters</span>
<span class="n">omega_ext</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">phi_ext</span> <span class="o">=</span> <span class="mf">0.</span>

<span class="n">omega_0</span> <span class="o">=</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">omega_ext</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">omega_0</span><span class="o">/</span><span class="mf">4.</span>

<span class="c1"># Instantiate the pendulu s</span>
<span class="n">gamma_ext</span> <span class="o">=</span> <span class="mf">1.060</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">Pendulum</span><span class="p">(</span><span class="n">omega_0</span><span class="o">=</span><span class="n">omega_0</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span> 
              <span class="n">gamma_ext</span><span class="o">=</span><span class="n">gamma_ext</span><span class="p">,</span> <span class="n">omega_ext</span><span class="o">=</span><span class="n">omega_ext</span><span class="p">,</span> <span class="n">phi_ext</span><span class="o">=</span><span class="n">phi_ext</span><span class="p">)</span>

<span class="n">gamma_ext</span> <span class="o">=</span> <span class="mf">1.078</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">Pendulum</span><span class="p">(</span><span class="n">omega_0</span><span class="o">=</span><span class="n">omega_0</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span> 
              <span class="n">gamma_ext</span><span class="o">=</span><span class="n">gamma_ext</span><span class="p">,</span> <span class="n">omega_ext</span><span class="o">=</span><span class="n">omega_ext</span><span class="p">,</span> <span class="n">phi_ext</span><span class="o">=</span><span class="n">phi_ext</span><span class="p">)</span>

<span class="n">gamma_ext</span> <span class="o">=</span> <span class="mf">1.081</span>
<span class="n">p3</span> <span class="o">=</span> <span class="n">Pendulum</span><span class="p">(</span><span class="n">omega_0</span><span class="o">=</span><span class="n">omega_0</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span> 
              <span class="n">gamma_ext</span><span class="o">=</span><span class="n">gamma_ext</span><span class="p">,</span> <span class="n">omega_ext</span><span class="o">=</span><span class="n">omega_ext</span><span class="p">,</span> <span class="n">phi_ext</span><span class="o">=</span><span class="n">phi_ext</span><span class="p">)</span>

<span class="n">gamma_ext</span> <span class="o">=</span> <span class="mf">1.0826</span>
<span class="n">p4</span> <span class="o">=</span> <span class="n">Pendulum</span><span class="p">(</span><span class="n">omega_0</span><span class="o">=</span><span class="n">omega_0</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span> 
              <span class="n">gamma_ext</span><span class="o">=</span><span class="n">gamma_ext</span><span class="p">,</span> <span class="n">omega_ext</span><span class="o">=</span><span class="n">omega_ext</span><span class="p">,</span> <span class="n">phi_ext</span><span class="o">=</span><span class="n">phi_ext</span><span class="p">)</span>

<span class="c1"># calculate the driving force for t_pts (all the same)</span>
<span class="n">driving</span> <span class="o">=</span> <span class="n">p1</span><span class="o">.</span><span class="n">driving_force</span><span class="p">(</span><span class="n">t_pts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># same initial conditions specified</span>
<span class="n">phi_0</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">2.</span>
<span class="n">phi_dot_0</span> <span class="o">=</span> <span class="mf">0.</span>

<span class="c1"># solve each of the pendulum odes</span>
<span class="n">phi_1</span><span class="p">,</span> <span class="n">phi_dot_1</span> <span class="o">=</span> <span class="n">p1</span><span class="o">.</span><span class="n">solve_ode</span><span class="p">(</span><span class="n">phi_0</span><span class="p">,</span> <span class="n">phi_dot_0</span><span class="p">)</span>
<span class="n">phi_2</span><span class="p">,</span> <span class="n">phi_dot_2</span> <span class="o">=</span> <span class="n">p2</span><span class="o">.</span><span class="n">solve_ode</span><span class="p">(</span><span class="n">phi_0</span><span class="p">,</span> <span class="n">phi_dot_0</span><span class="p">)</span>
<span class="n">phi_3</span><span class="p">,</span> <span class="n">phi_dot_3</span> <span class="o">=</span> <span class="n">p3</span><span class="o">.</span><span class="n">solve_ode</span><span class="p">(</span><span class="n">phi_0</span><span class="p">,</span> <span class="n">phi_dot_0</span><span class="p">)</span>
<span class="n">phi_4</span><span class="p">,</span> <span class="n">phi_dot_4</span> <span class="o">=</span> <span class="n">p4</span><span class="o">.</span><span class="n">solve_ode</span><span class="p">(</span><span class="n">phi_0</span><span class="p">,</span> <span class="n">phi_dot_0</span><span class="p">)</span>

<span class="c1"># Change the common font size</span>
<span class="n">font_size</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="n">font_size</span><span class="p">})</span>
<span class="n">box_props</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;wheat&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># start the plot!</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">overall_title</span> <span class="o">=</span> <span class="s1">&#39;Taylor Figure 12.8:  &#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\omega = </span><span class="si">{</span><span class="n">omega_ext</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">,$&#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\omega_0 = </span><span class="si">{</span><span class="n">omega_0</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">,$&#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\beta = </span><span class="si">{</span><span class="n">beta</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">,$&#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39;  $\phi_0 = </span><span class="si">{</span><span class="n">phi_0</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">,$&#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\dot\phi_0 = </span><span class="si">{</span><span class="n">phi_dot_0</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">$&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>     <span class="c1"># \n means a new line (adds some space here)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">overall_title</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">)</span>
    
<span class="c1"># plot 1a: plot from t=0 to t=10   </span>
<span class="n">ax_1a</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>                  
<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">)</span>    
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">t_pts</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> <span class="n">phi_1</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="n">phi_vs_time_labels</span><span class="p">,</span> 
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_1a</span><span class="p">)</span> 
<span class="n">ax_1a</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">)</span>
<span class="n">ax_1a</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">textstr</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\gamma = 1.060$&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; Period 1&#39;</span>
<span class="n">ax_1a</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">5.8</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">textstr</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">box_props</span><span class="p">)</span>
    
<span class="c1"># plot 1b: plot from t=28 to t=40 blown up   </span>
<span class="n">ax_1b</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>                  
<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">28.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">)</span>    
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">t_pts</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> <span class="n">phi_1</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="n">phi_vs_time_labels</span><span class="p">,</span> 
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s1">&#39;$\gamma = 1.060$&#39;</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_1b</span><span class="p">)</span> 
<span class="n">ax_1b</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.6</span><span class="p">)</span>
    
<span class="c1"># plot 2a: plot from t=0 to t=10   </span>
<span class="n">ax_2a</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>                  
<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">)</span>    
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">t_pts</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> <span class="n">phi_2</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="n">phi_vs_time_labels</span><span class="p">,</span> 
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_2a</span><span class="p">)</span> 
<span class="n">ax_2a</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">)</span>
<span class="n">ax_2a</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">textstr</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\gamma = 1.078$&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; Period 2&#39;</span>
<span class="n">ax_2a</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">5.8</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">textstr</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">box_props</span><span class="p">)</span>
    
<span class="c1"># plot 2b: plot from t=28 to t=40 blown up   </span>
<span class="n">ax_2b</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>                  
<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">28.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">)</span>    
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">t_pts</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> <span class="n">phi_2</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="n">phi_vs_time_labels</span><span class="p">,</span> 
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s1">&#39;$\gamma = 1.078$&#39;</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_2b</span><span class="p">)</span> 
<span class="n">ax_2b</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.6</span><span class="p">)</span>
    
<span class="c1"># plot 3a: plot from t=0 to t=10   </span>
<span class="n">ax_3a</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>                  
<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">)</span>    
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">t_pts</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> <span class="n">phi_3</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="n">phi_vs_time_labels</span><span class="p">,</span> 
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_3a</span><span class="p">)</span> 
<span class="n">ax_3a</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">)</span>
<span class="n">ax_3a</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">textstr</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\gamma = 1.081$&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; Period 4&#39;</span>
<span class="n">ax_3a</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">5.8</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">textstr</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">box_props</span><span class="p">)</span>
    
<span class="c1"># plot 3b: plot from t=28 to t=40 blown up   </span>
<span class="n">ax_3b</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>                  
<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">28.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">)</span>    
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">t_pts</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> <span class="n">phi_3</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="n">phi_vs_time_labels</span><span class="p">,</span> 
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_3b</span><span class="p">)</span> 
<span class="n">ax_3b</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.6</span><span class="p">)</span>
    
<span class="c1"># plot 4a: plot from t=0 to t=10   </span>
<span class="n">ax_4a</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>                  
<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">)</span>    
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">t_pts</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> <span class="n">phi_4</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="n">phi_vs_time_labels</span><span class="p">,</span> 
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_4a</span><span class="p">)</span> 
<span class="n">ax_4a</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">)</span>
<span class="n">ax_4a</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">textstr</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\gamma = 1.0826$&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; Period 8&#39;</span>
<span class="n">ax_4a</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">5.8</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">textstr</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">box_props</span><span class="p">)</span>
    
<span class="c1"># plot 4b: plot from t=28 to t=40 blown up   </span>
<span class="n">ax_4b</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>                  
<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="mf">28.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">)</span>    
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">t_pts</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> <span class="n">phi_4</span><span class="p">[</span><span class="n">start</span> <span class="p">:</span> <span class="n">stop</span><span class="p">],</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="n">phi_vs_time_labels</span><span class="p">,</span> 
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_4b</span><span class="p">)</span> 
<span class="n">ax_4b</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.6</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;Figure_12.8.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>  <span class="c1"># always bbox_inches=&#39;tight&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Multiple_pendulum_plots_Section_12.4-Copy1_35_0.png" src="../../_images/Multiple_pendulum_plots_Section_12.4-Copy1_35_0.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "furnstahl/5300-JB",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks/Taylor_problems"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Dick Furnstahl<br/>
        
            &copy; Copyright 2022.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>