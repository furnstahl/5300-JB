
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Taylor Examples 5.4 and 5.5 &#8212; Theoretical and computational mechanics</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"N": "\\mathbb{N}", "avec": ["\\boldsymbol{a}"], "floor": ["\\lfloor#1\\rfloor", 1], "bmat": ["\\left[\\begin{array}"], "emat": ["\\end{array}\\right]"]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/5300_icon.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Theoretical and computational mechanics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../about.html">
   About Physics 5300: Theoretical and Computational Mechanics
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Course overview
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../content/Course/overview.html">
   Objectives
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../content/Reference/installing_anaconda.html">
   Using Anaconda
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Reference/python_jupyter.html">
   Python and Jupyter notebooks
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reference/Jupyter_Python_intro_01.html">
     Python and Jupyter notebooks: part 01
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Reference/advanced.html">
   Advanced topics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/Reference/using_github.html">
     Using GitHub
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reference/Jupyter_Python_intro_02.html">
     Python and Jupyter notebooks: part 02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reference/Simple_widgets_v1.html">
     Widgets in Jupyter
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Taylor problem notebooks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Taylor/Taylor_chapters_1to4.html">
   Taylor Chapters 1 to 4
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_1.39.html">
     Taylor problem 1.39
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_1.50.html">
     Taylor problem 1.50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_1.50_supplement1.html">
     Taylor problem 1.50 supplement
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_2.20_template.html">
     Taylor problem 2.20 Template
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_2.40_template.html">
     Taylor problem 2.40
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_2.43_template.html">
     Taylor problem 2.43
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_3.23.html">
     Taylor problem 3.23
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_4.29_template.html">
     Taylor problem 4.29 template
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_4.37_template.html">
     Taylor problem 4.37 template
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/Pendulum_widget_visualization_v02.html">
     Pendulum visualization using ipywidgets
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Taylor/Taylor_chapter_5.html">
   Taylor Chapter 5
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_5.2.html">
     Taylor problem 5.2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_5.13.html">
     Taylor problem 5.2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_5.32.html">
     Taylor problem 5.32
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_5.36.html">
     Taylor problem 5.36 (with Example 5.3 graphs)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_5.36_atan2.html">
     Taylor problem 5.36 (with Example 5.3 graphs)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_Example_5.5.html">
     Taylor Examples 5.4 and 5.5
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Taylor_problem_5.50.html">
     Taylor problem 5.50
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/Harmonic_oscillator_visualization_v03.html">
     Harmonic oscillator visualization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/Linear_operator_games.html">
     Demo notebook for linear operators as matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/Fourier_coefficient_intuition_v1.html">
     Fourier coefficient intuition
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Taylor/Taylor_chapter_12.html">
   Taylor Chapter 12
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Multiple_pendulum_plots_Section_12.3.html">
     Multiple pendulum plots: Section 12.3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Multiple_pendulum_plots_Section_12.4.html">
     Multiple pendulum plots. Section 12.4: Approach to Chaos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Multiple_pendulum_plots_Section_12.5.html">
     Multiple pendulum plots. Section 12.5: Chaos and sensitivity to initial conditions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Multiple_pendulum_plots_Section_12.8.html">
     Multiple pendulum plots. Section 12.8: Poincare Sections
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/pendulum_animation_notebook_v2.html">
     Basic pendulum animations: using %matplotlib notebook
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/two_pendulum_animation_v1.html">
     Two pendulum animations (using %matplotlib notebook)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/Logistic_map_explorations.html">
     Logistic map explorations (Taylor and beyond)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/sine_map_explorations_v2.html">
     Sine map explorations (Taylor and beyond)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Taylor/Taylor_chapter_6.html">
   Taylor Chapter 6
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/pendulum_animation_notebook_v3.html">
     Basic pendulum animations: using %matplotlib notebook
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/visualizing_stationary_functional_v1.html">
     Visualizing stationary paths of a  functional
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Sandboxes/Brachistochrone_static_homework.html">
     Brachistochrone problem (static)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reference/ODEs_with_solve_ivp.html">
     Solving ODEs with scipy.integrate.solve_ivp
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reference/Plotting_every_period_and_making_tables.html">
     Plotting every period and printing tables
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reference/test_of_GridSpec.html">
     Test of GridSpec
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reference material
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../content/zbibliography.html">
   Bibliography
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/notebooks/Taylor_problems/Taylor_Example_5.5-Copy1.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/furnstahl/5300-JB"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/furnstahl/5300-JB/issues/new?title=Issue%20on%20page%20%2Fnotebooks/Taylor_problems/Taylor_Example_5.5-Copy1.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/furnstahl/5300-JB/main?urlpath=tree/./notebooks/Taylor_problems/Taylor_Example_5.5-Copy1.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#define-the-functions-well-need">
   Define the functions we’ll need
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-5-4">
   Example 5.4
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-5-5">
   Example 5.5
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="taylor-examples-5-4-and-5-5">
<h1>Taylor Examples 5.4 and 5.5<a class="headerlink" href="#taylor-examples-5-4-and-5-5" title="Permalink to this headline">¶</a></h1>
<p>last revised: 17-Jan-2019 by Dick Furnstahl [furnstahl.1&#64;osu.edu]</p>
<p>Here we are exploring the Fourier series for a waveform defined to be even about the origin, so <span class="math notranslate nohighlight">\(f(-t) = +f(t)\)</span>, with period <span class="math notranslate nohighlight">\(\tau\)</span>.  That means that the integrand for the <span class="math notranslate nohighlight">\(b_m\)</span> coefficients is odd and so all of the corresponding integrals vanish.</p>
<p>The particular wave of interest here is a periodic rectangular pulse, such that in the interval <span class="math notranslate nohighlight">\(-\tau/2 \leq t \leq \tau/2\)</span>, the function takes the form:</p>
<p><span class="math notranslate nohighlight">\(\newcommand{\fmax}{f_{\textrm{max}}}\)</span>
<span class="math notranslate nohighlight">\(\begin{align}
  f(t) = \left\{ \begin{array}{lc}
                   \fmax &amp; -\Delta\tau/2 &lt; t &lt; \Delta\tau/2 \\
                   0 &amp; |t| &gt; \Delta\tau/2 
                 \end{array}
                   \right.
\end{align}\)</span></p>
<p>As usual, we do the <span class="math notranslate nohighlight">\(a_0\)</span> integral separately and then <span class="math notranslate nohighlight">\(a_m\)</span> for <span class="math notranslate nohighlight">\(m \geq 1\)</span>.  Here <span class="math notranslate nohighlight">\(\omega \equiv 2\pi/\tau\)</span>.  The results are (also see the text):</p>
<p><span class="math notranslate nohighlight">\(\begin{align}
  a_0 = \frac{1}{\tau} \int_{-\tau/2}^{\tau/2} f(t)\, dt = \frac{\fmax\Delta\tau}{\tau}
\end{align}\)</span></p>
<p><span class="math notranslate nohighlight">\(\begin{align}
  a_m = \frac{2}{\tau} \int_{-\tau/2}^{\tau/2} \cos(m\omega t) f(t)\, dt = 
      \frac{4\fmax}{\tau} \int_0^{\Delta\tau/2} \cos(2\pi m t/\tau) \, dt 
    %  &amp;= - \frac{2\fmax}{m\pi}\left[\cos(m\pi t)\right]^1_0 \\
      =
        \frac{2 \fmax}{m\pi} \sin\left(\frac{\pi m \Delta\tau}{\tau}\right)
\end{align}\)</span></p>
<div class="section" id="define-the-functions-well-need">
<h2>Define the functions we’ll need<a class="headerlink" href="#define-the-functions-well-need" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
</pre></div>
</div>
</div>
</div>
<p>We start by defining a function for the rectangular pulse at any <span class="math notranslate nohighlight">\(t\)</span>.  The definition here is for a scalar function.  That is, it won’t work to call it with <span class="math notranslate nohighlight">\(t\)</span> and array of time points, unlike other functions we have defined.  It is possible to make it work, but then the function will be much less clear.  When we need to evaluate it for all elements of an array <code class="docutils literal notranslate"><span class="pre">t_pts</span></code>, we will use the construction: <br/> <code class="docutils literal notranslate"><span class="pre">np.array([rectangular(t)</span> <span class="pre">for</span> <span class="pre">t</span> <span class="pre">in</span> <span class="pre">t_pts])</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rectangular</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">Delta_tau</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">f_max</span><span class="o">=</span><span class="mf">1.</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the rectangular wave of amplitude f_max and even about the </span>
<span class="sd">        origin at time t.  The period is tau.  It is defined as a scalar </span>
<span class="sd">        function (i.e., only one value of t can be passed at a time). </span>
<span class="sd">        **There must be a better way to define this!**</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t_adjust</span> <span class="o">=</span> <span class="n">t</span> <span class="o">-</span> <span class="nb">round</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>  <span class="c1"># shift t so we can test for being within Delta_tau</span>
        
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">t_adjust</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Delta_tau</span><span class="o">/</span><span class="mf">2.</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">f_max</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.</span> 
</pre></div>
</div>
</div>
</div>
<p>Now a function that creates an array of Fourier coefficients for the triangular wave up to order N_max.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rectangular_coeffs_by_hand</span><span class="p">(</span><span class="n">N_max</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">Delta_tau</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">f_max</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Fourier coefficients calculated by hand and loaded into an array</span>
<span class="sd">        as pairs in the form (a_n, b_n).  </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># initialize the array with the vaues of a_0 and b_0</span>
    <span class="n">coeffs_array</span> <span class="o">=</span> <span class="p">[(</span><span class="n">f_max</span> <span class="o">*</span> <span class="n">Delta_tau</span> <span class="o">/</span> <span class="n">tau</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>   
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N_max</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="c1"># these are pre-calcualated values of a_n and b_n</span>
        <span class="n">a_n</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">f_max</span><span class="o">/</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="n">Delta_tau</span><span class="p">)</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span>
        <span class="n">b_n</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="n">coeffs_array</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">a_n</span><span class="p">,</span> <span class="n">b_n</span><span class="p">))</span>  <span class="c1"># add them to the end of the array   </span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coeffs_array</span><span class="p">)</span>  <span class="c1"># convert to a numpy array to be safe</span>
</pre></div>
</div>
</div>
</div>
<p>We would like a general way to construct the array of Fourier coefficients given any periodic function.  Our first pass at that uses a class definition and the scipy integration function quad.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">FourierSeries</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fourier series class finds the coefficients in a Fourier series with</span>
<span class="sd">    period tau up to a specified order.</span>
<span class="sd">    Assume these imports:</span>
<span class="sd">        from scipy.integrate import quad</span>
<span class="sd">        import numpy as np</span>
<span class="sd">    ***Need to add args to the function.***     </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">function</span><span class="p">,</span>
                 <span class="n">tau</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span>
                 <span class="n">N_max</span><span class="o">=</span><span class="mi">10</span>
                <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">function</span> <span class="o">=</span> <span class="n">function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tau</span> <span class="o">=</span> <span class="n">tau</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">tau</span>    
        <span class="bp">self</span><span class="o">.</span><span class="n">N_max</span> <span class="o">=</span> <span class="n">N_max</span>
        <span class="c1"># add something to quit if Nmax &lt; 0 or not an integer (try and except)</span>

    <span class="k">def</span> <span class="nf">a0_calc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the constant Fourier coefficient by integration&quot;&quot;&quot;</span>
        <span class="n">answer</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="p">,</span> <span class="o">-</span><span class="n">tau</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="n">tau</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">tau</span><span class="p">,))</span>
        <span class="k">return</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">tau</span><span class="p">)</span> <span class="o">*</span> <span class="n">answer</span>
    
    <span class="k">def</span> <span class="nf">an_integrand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Integrand for the nth cosine coefficient&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tau</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">an_calc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the nth cosine coefficient (n &gt; 0)&quot;&quot;&quot;</span>
        <span class="c1"># note comma after n in args</span>
        <span class="n">answer</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">an_integrand</span><span class="p">,</span> <span class="o">-</span><span class="n">tau</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="n">tau</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,))</span>  
        <span class="k">return</span> <span class="p">(</span><span class="mf">2.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">tau</span><span class="p">)</span> <span class="o">*</span> <span class="n">answer</span>
    
    <span class="k">def</span> <span class="nf">bn_integrand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Integrand for the nth cosine coefficient&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tau</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">bn_calc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the nth cosine coefficient (n &gt; 0)&quot;&quot;&quot;</span>
        <span class="n">answer</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bn_integrand</span><span class="p">,</span> <span class="o">-</span><span class="n">tau</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="n">tau</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,))</span>  
        <span class="k">return</span> <span class="p">(</span><span class="mf">2.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">tau</span><span class="p">)</span> <span class="o">*</span> <span class="n">answer</span>
        
    <span class="k">def</span> <span class="nf">coeffs_upto_Nmax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the Fourier series up to Nmax&quot;&quot;&quot;</span>
        <span class="c1"># first generate the coefficient</span>
        <span class="n">coeffs_array</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">a0_calc</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)]</span>   <span class="c1"># a_0 and b_0</span>
        
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N_max</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">a_n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">an_calc</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="n">b_n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bn_calc</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="n">coeffs_array</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">a_n</span><span class="p">,</span> <span class="n">b_n</span><span class="p">))</span>  <span class="c1"># append a tuple of coefficients</span>
    
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coeffs_array</span><span class="p">)</span>  <span class="c1"># convert to a numpy array  </span>
    
</pre></div>
</div>
</div>
</div>
<p>Finally, we need a function that can take as input an array of t values and an array of Fourier coefficients and return the function at those t values with terms up to order N_max.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Fourier_reconstruct</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="n">coeffs_array</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">N_max</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sum up the Fourier series up to n = N_max terms.&quot;&quot;&quot;</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">tau</span>   <span class="c1"># definition of omega</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="c1"># iterate over coefficients but only up to N_max</span>
    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coeffs_array</span><span class="p">[:</span><span class="n">N_max</span><span class="o">+</span><span class="mi">1</span><span class="p">]):</span>  
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">+</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">omega</span> <span class="o">*</span> <span class="n">t_pts</span><span class="p">)</span> \
                        <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">omega</span> <span class="o">*</span> <span class="n">t_pts</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>    
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="example-5-4">
<h2>Example 5.4<a class="headerlink" href="#example-5-4" title="Permalink to this headline">¶</a></h2>
<p>Ok, now we can do Example 5.4.  Calculate the coefficients both ways.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N_max</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">f_max</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">Delta_tau</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="n">coeffs_by_hand</span> <span class="o">=</span> <span class="n">rectangular_coeffs_by_hand</span><span class="p">(</span><span class="n">N_max</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">Delta_tau</span><span class="p">,</span> <span class="n">f_max</span><span class="p">)</span>

<span class="n">fs</span> <span class="o">=</span> <span class="n">FourierSeries</span><span class="p">(</span><span class="n">rectangular</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">N_max</span><span class="p">)</span>
<span class="n">coeffs_by_quad</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">coeffs_upto_Nmax</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s check that the exact and numerical calculation of the coefficients agree.</p>
<p>(Note the space in the formats below, e.g., <code class="docutils literal notranslate"><span class="pre">{a1:</span> <span class="pre">.6f}</span></code>.  This means to leave an extra space for a positive number so that it aligns at the decimal point with negative numbers.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39; n   a_exact     a_quad      b_exact     b_quad&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="p">((</span><span class="n">a1</span><span class="p">,</span><span class="n">b1</span><span class="p">),</span> <span class="p">(</span><span class="n">a2</span><span class="p">,</span><span class="n">b2</span><span class="p">))</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">coeffs_by_hand</span><span class="p">,</span> <span class="n">coeffs_by_quad</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">n</span><span class="si">:</span><span class="s1">2d</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">a1</span><span class="si">:</span><span class="s1"> .6f</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">a2</span><span class="si">:</span><span class="s1"> .6f</span><span class="si">}</span><span class="s1">    </span><span class="si">{</span><span class="n">b1</span><span class="si">:</span><span class="s1"> .6f</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">b2</span><span class="si">:</span><span class="s1"> .6f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> n   a_exact     a_quad      b_exact     b_quad
 0   0.250000   0.250000     0.000000   0.000000
 1   0.450158   0.450158     0.000000   0.000000
 2   0.318310   0.318310     0.000000   0.000000
 3   0.150053   0.150053     0.000000   0.000000
 4   0.000000   0.000000     0.000000   0.000000
 5  -0.090032  -0.090032     0.000000   0.000000
 6  -0.106103  -0.106103     0.000000   0.000000
 7  -0.064308  -0.064308     0.000000   0.000000
 8  -0.000000   0.000000     0.000000   0.000000
 9   0.050018   0.050018     0.000000   0.000000
10   0.063662   0.063662     0.000000   0.000000
11   0.040923   0.040923     0.000000   0.000000
12   0.000000   0.000000     0.000000   0.000000
13  -0.034628  -0.034628     0.000000   0.000000
14  -0.045473  -0.045473     0.000000   0.000000
15  -0.030011  -0.030011     0.000000   0.000000
16  -0.000000   0.000000     0.000000   0.000000
17   0.026480   0.026480     0.000000   0.000000
18   0.035368   0.035368     0.000000   0.000000
19   0.023693   0.023693     0.000000   0.000000
</pre></div>
</div>
</div>
</div>
<p>Make the comparison plot requested: N_max = 2 vs. N_max = 6.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">.01</span><span class="p">)</span>
<span class="n">f_pts_2</span> <span class="o">=</span> <span class="n">Fourier_reconstruct</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="n">coeffs_by_hand</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">f_pts_6</span> <span class="o">=</span> <span class="n">Fourier_reconstruct</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="n">coeffs_by_hand</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="c1"># Python way to evaluate the rectangular function at an array of points:</span>
<span class="c1">#   * np.array creates a numpy array;</span>
<span class="c1">#   * note the []s around the inner statement;</span>
<span class="c1">#   * rectangular(t) for t in t_pts  </span>
<span class="c1">#       means step through each element of t_pts, call it t, and</span>
<span class="c1">#       evaluate rectangular at that t.</span>
<span class="c1">#   * This is called a list comprehension.  There are more compact ways,</span>
<span class="c1">#      but this is clear and easy to debug.</span>
<span class="n">rectangular_t_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">rectangular</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">Delta_tau</span><span class="p">,</span> <span class="n">f_max</span><span class="p">)</span> \
                              <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_pts</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># It looks like we should define a function for the axis!</span>

<span class="n">fig_1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="n">ax_1</span> <span class="o">=</span> <span class="n">fig_1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax_1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="n">f_pts_2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;N = 2&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax_1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="n">rectangular_t_pts</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;exact&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax_1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">4.1</span><span class="p">)</span>
<span class="n">ax_1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">ax_1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;f(t)&#39;</span><span class="p">)</span>
<span class="n">ax_1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;N = 2&#39;</span><span class="p">)</span>
<span class="n">ax_1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax_2</span> <span class="o">=</span> <span class="n">fig_1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax_2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="n">f_pts_6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;N = 6&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax_2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="n">rectangular_t_pts</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;exact&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax_2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">4.1</span><span class="p">)</span>
<span class="n">ax_2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">ax_2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;f(t)&#39;</span><span class="p">)</span>
<span class="n">ax_2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;N = 6&#39;</span><span class="p">)</span>
<span class="n">ax_2</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>

<span class="n">fig_1</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig_1</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;example_5.4.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Taylor_Example_5.5-Copy1_18_0.png" src="../../_images/Taylor_Example_5.5-Copy1_18_0.png" />
</div>
</div>
</div>
<div class="section" id="example-5-5">
<h2>Example 5.5<a class="headerlink" href="#example-5-5" title="Permalink to this headline">¶</a></h2>
<p>We consider a driven oscillator with an even driving force so only cosine terms are non-zero in the Fourier transform of <span class="math notranslate nohighlight">\(f(t)\)</span>.  Linearity of the equation then means that the solution takes the form</p>
<p><span class="math notranslate nohighlight">\(\begin{align}
  x(t) = \sum_{n=0}^{\infty} A_n \cos(n\omega t - \delta_n) \;,
\end{align}\)</span></p>
<p>where</p>
<p><span class="math notranslate nohighlight">\(\begin{align}
  A_n &amp;= \frac{f_n}{\sqrt{(\omega_0^2 - n^2 \omega^2)^2 + 4\beta^2 n^2 \omega^2}}  \\
  \delta_n &amp;= \arctan\left(\frac{2\beta n\omega}{\omega_0^2 - n^2 \omega^2}  \right)
\end{align}\)</span></p>
<p>For Example 5.5 we apply this to the rectangular driving force, so we can use the coefficients from Example 5.4, which play the role of the <span class="math notranslate nohighlight">\(f_n\)</span> coefficients here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">driven_coefficients</span><span class="p">(</span><span class="n">tau_0</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the coefficients A_n and delta_n for a driven oscillator.&quot;&quot;&quot;</span>
    <span class="n">omega_0</span> <span class="o">=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">tau_0</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">tau</span>
    
    <span class="n">A_n</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">delta_n</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="c1"># the second entry in the tuple is called dummy because it is not used</span>
    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">f_n</span><span class="p">,</span> <span class="n">dummy</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coeffs</span><span class="p">):</span>
        <span class="n">A_n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f_n</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">omega_0</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">n</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> 
                                  <span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span><span class="n">omega</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">delta_n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span><span class="n">omega</span><span class="p">,</span> 
                                  <span class="n">omega_0</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">n</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span> <span class="p">))</span>  
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">A_n</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">delta_n</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">x_drive</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="n">tau_0</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">N_max</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;Sum up the Fourier series for x(t) up to n = N_max terms.&quot;&quot;&quot;</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">tau</span>
    <span class="n">A_n_array</span><span class="p">,</span> <span class="n">delta_n_array</span> <span class="o">=</span> <span class="n">driven_coefficients</span><span class="p">(</span><span class="n">tau_0</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">)</span> 
    
    <span class="n">result</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="c1"># iterate over coefficients but only up to N_max</span>
    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">A_n</span><span class="p">,</span> <span class="n">delta_n</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">A_n_array</span><span class="p">[:</span><span class="n">N_max</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> 
                                           <span class="n">delta_n_array</span><span class="p">[:</span><span class="n">N_max</span><span class="o">+</span><span class="mi">1</span><span class="p">])):</span> 
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">+</span> <span class="n">A_n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span> <span class="n">n</span> <span class="o">*</span> <span class="n">omega</span> <span class="o">*</span> <span class="n">t_pts</span> <span class="o">-</span> <span class="n">delta_n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>    
</pre></div>
</div>
</div>
</div>
<p>Ok, let’s do Example 5.5!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N_max</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">f_max</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">Delta_tau</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="n">coeffs_by_hand</span> <span class="o">=</span> <span class="n">rectangular_coeffs_by_hand</span><span class="p">(</span><span class="n">N_max</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">Delta_tau</span><span class="p">,</span> <span class="n">f_max</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">,</span> <span class="mf">.01</span><span class="p">)</span>

<span class="c1"># first set of parameters</span>
<span class="n">N_max</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">f_max</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">Delta_tau</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">coeffs_by_hand_1</span> <span class="o">=</span> <span class="n">rectangular_coeffs_by_hand</span><span class="p">(</span><span class="n">N_max</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">Delta_tau</span><span class="p">,</span> <span class="n">f_max</span><span class="p">)</span>

<span class="n">tau_0_1</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">A_n_array_1</span><span class="p">,</span> <span class="n">delta_n_array_1</span> <span class="o">=</span> <span class="n">driven_coefficients</span><span class="p">(</span><span class="n">tau_0_1</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> 
                                                   <span class="n">coeffs_by_hand_1</span><span class="p">)</span> 
<span class="n">x_pts_1</span> <span class="o">=</span> <span class="n">x_drive</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="n">tau_0_1</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">N_max</span><span class="p">,</span> <span class="n">coeffs_by_hand_1</span><span class="p">)</span>


<span class="c1"># now only tau is varied</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">coeffs_by_hand_2</span> <span class="o">=</span> <span class="n">rectangular_coeffs_by_hand</span><span class="p">(</span><span class="n">N_max</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">Delta_tau</span><span class="p">,</span> <span class="n">f_max</span><span class="p">)</span>

<span class="n">tau_0_2</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">A_n_array_2</span><span class="p">,</span> <span class="n">delta_n_array_2</span> <span class="o">=</span> <span class="n">driven_coefficients</span><span class="p">(</span><span class="n">tau_0_2</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> 
                                                   <span class="n">coeffs_by_hand_2</span><span class="p">)</span> 
<span class="n">x_pts_2</span> <span class="o">=</span> <span class="n">x_drive</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="n">tau_0_2</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">N_max</span><span class="p">,</span> <span class="n">coeffs_by_hand_2</span><span class="p">)</span>



<span class="c1"># now only tau is varied</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">coeffs_by_hand_3</span> <span class="o">=</span> <span class="n">rectangular_coeffs_by_hand</span><span class="p">(</span><span class="n">N_max</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">Delta_tau</span><span class="p">,</span> <span class="n">f_max</span><span class="p">)</span>

<span class="n">tau_0_3</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">A_n_array_3</span><span class="p">,</span> <span class="n">delta_n_array_3</span> <span class="o">=</span> <span class="n">driven_coefficients</span><span class="p">(</span><span class="n">tau_0_3</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> 
                                                   <span class="n">coeffs_by_hand_3</span><span class="p">)</span> 
<span class="n">x_pts_3</span> <span class="o">=</span> <span class="n">x_drive</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="n">tau_0_3</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">N_max</span><span class="p">,</span> <span class="n">coeffs_by_hand_3</span><span class="p">)</span>



<span class="c1"># now only tau is varied</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="n">coeffs_by_hand_4</span> <span class="o">=</span> <span class="n">rectangular_coeffs_by_hand</span><span class="p">(</span><span class="n">N_max</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">Delta_tau</span><span class="p">,</span> <span class="n">f_max</span><span class="p">)</span>

<span class="n">tau_0_4</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">A_n_array_4</span><span class="p">,</span> <span class="n">delta_n_array_4</span> <span class="o">=</span> <span class="n">driven_coefficients</span><span class="p">(</span><span class="n">tau_0_4</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> 
                                                   <span class="n">coeffs_by_hand_4</span><span class="p">)</span> 
<span class="n">x_pts_4</span> <span class="o">=</span> <span class="n">x_drive</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="n">tau_0_4</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">N_max</span><span class="p">,</span> <span class="n">coeffs_by_hand_4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>How would you code the last cell differently so that you could just give an array of <span class="math notranslate nohighlight">\(\tau\)</span> values?</p>
<p>Compare coefficients for the cases from parts 1 to 4: large <span class="math notranslate nohighlight">\(A_n\)</span> coefficients when that component is in resonance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39; n      case 1        case 2        case 3        case 4&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">A_n_1</span><span class="p">,</span> <span class="n">A_n_2</span><span class="p">,</span> <span class="n">A_n_3</span><span class="p">,</span> <span class="n">A_n_4</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">A_n_array_1</span><span class="p">,</span> <span class="n">A_n_array_2</span><span class="p">,</span> 
                                                     <span class="n">A_n_array_3</span><span class="p">,</span> <span class="n">A_n_array_4</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">n</span><span class="si">:</span><span class="s1">2d</span><span class="si">}</span><span class="s1">   </span><span class="si">{</span><span class="n">A_n_1</span><span class="si">:</span><span class="s1"> .8f</span><span class="si">}</span><span class="s1">   </span><span class="si">{</span><span class="n">A_n_2</span><span class="si">:</span><span class="s1"> .8f</span><span class="si">}</span><span class="s1">   </span><span class="si">{</span><span class="n">A_n_3</span><span class="si">:</span><span class="s1"> .8f</span><span class="si">}</span><span class="s1">   </span><span class="si">{</span><span class="n">A_n_4</span><span class="si">:</span><span class="s1"> .8f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> n      case 1        case 2        case 3        case 4
 0    0.00633257    0.00422172    0.00316629    0.00253303
 1    0.17911224    0.01447102    0.00822068    0.00592958
 2    0.00268521    0.00892472    0.08955612    0.01303477
 3    0.00047497    0.00179014    0.00396133    0.00973767
 4    0.00000000    0.00057109    0.00134261    0.00245255
 5   -0.00009501    0.00015945    0.00056729    0.00107408
 6   -0.00007678    0.00000000    0.00023749    0.00053672
 7   -0.00003393   -0.00005543    0.00007835    0.00027238
 8   -0.00000000   -0.00006360    0.00000000    0.00012820
 9    0.00001584   -0.00005119   -0.00003562    0.00004629
10    0.00001629   -0.00003214   -0.00004751    0.00000000
11    0.00000864   -0.00001389   -0.00004630   -0.00002467
12    0.00000000   -0.00000000   -0.00003839   -0.00003583
13   -0.00000522    0.00000837   -0.00002778   -0.00003854
14   -0.00000591    0.00001158   -0.00001697   -0.00003608
15   -0.00000339    0.00001086   -0.00000745   -0.00003071
16   -0.00000000    0.00000774   -0.00000000   -0.00002399
17    0.00000233    0.00000372    0.00000509   -0.00001696
18    0.00000277    0.00000000    0.00000792   -0.00001036
19    0.00000167   -0.00000266    0.00000879   -0.00000462
</pre></div>
</div>
</div>
</div>
<p>Now for the graphs in Figure 5.25:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig_2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="n">ax_1</span> <span class="o">=</span> <span class="n">fig_2</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax_1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="n">x_pts_1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax_1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">)</span>
<span class="n">ax_1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax_1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">ax_1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x(t)&#39;</span><span class="p">)</span>
<span class="n">ax_1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;case (1): $\tau = 1$&#39;</span><span class="p">)</span>

<span class="n">ax_2</span> <span class="o">=</span> <span class="n">fig_2</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax_2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="n">x_pts_2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax_2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">)</span>
<span class="n">ax_2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax_2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">ax_2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x(t)&#39;</span><span class="p">)</span>
<span class="n">ax_2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;case (2): $\tau = 1.5$&#39;</span><span class="p">)</span>

<span class="n">ax_3</span> <span class="o">=</span> <span class="n">fig_2</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax_3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="n">x_pts_3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax_3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">)</span>
<span class="n">ax_3</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax_3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">ax_3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x(t)&#39;</span><span class="p">)</span>
<span class="n">ax_3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;case (3): $\tau = 2.0$&#39;</span><span class="p">)</span>

<span class="n">ax_4</span> <span class="o">=</span> <span class="n">fig_2</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax_4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="n">x_pts_4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax_4</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">)</span>
<span class="n">ax_4</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax_4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">ax_4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x(t)&#39;</span><span class="p">)</span>
<span class="n">ax_4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;case (4): $\tau = 2.5$&#39;</span><span class="p">)</span>

<span class="n">fig_2</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig_2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;Example_.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Taylor_Example_5.5-Copy1_30_0.png" src="../../_images/Taylor_Example_5.5-Copy1_30_0.png" />
</div>
</div>
<p>To add additional graphs with more <span class="math notranslate nohighlight">\(\tau\)</span> values, we should really define a function that produces the plot given a <span class="math notranslate nohighlight">\(\tau\)</span>.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "furnstahl/5300-JB",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks/Taylor_problems"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Dick Furnstahl<br/>
        
            &copy; Copyright 2022.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>